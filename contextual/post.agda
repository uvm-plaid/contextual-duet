{-# OPTIONS --allow-unsolved-metas #-}
module post where

open import rules public
open import logical-relations public

postulate
  L1 : âˆ€ (N : â„•) â†’ âˆ£ N - N âˆ£ â‰¡ 0
  L2 : âˆ€ (N : â„•) â†’ âŸ¨ âˆ£ N - N âˆ£ âŸ© â‰¡< qty â„• > âŸ¨ 0 âŸ©
  L3 : âˆ€ {a b c d N : â„•} {Î£â‚ Î£â‚‚ Î£â‚ƒ : Î£[ N ]} â†’ âŸ¨ âˆ£ a - b âˆ£ âŸ© â‰¤ (Î£â‚ â¨° Î£â‚ƒ) â†’ âŸ¨ âˆ£ c - d âˆ£ âŸ© â‰¤ (Î£â‚‚ â¨° Î£â‚ƒ) â†’ âŸ¨ âˆ£ (a + c) - (b + d) âˆ£ âŸ© â‰¤ ((Î£â‚ + Î£â‚‚) â¨° Î£â‚ƒ)
  L4 : âˆ€ {N} (Î£â‚ Î£â‚‚ Î£â‚ƒ : Î£[ N ]) â†’ (Î£â‚ â¨° Î£â‚ƒ) + (Î£â‚‚ â¨° Î£â‚ƒ) â‰¡ ((Î£â‚ + Î£â‚‚) â¨° Î£â‚ƒ)
  L5 : âˆ€ {N} (Î£â‚ Î£â‚‚ : Î£[ N ]) â†’ (Î£â‚ â¨° Î£â‚‚) â‰¡ (Î£â‚‚ â¨° Î£â‚)
  L6 : âˆ€ {N} (Î£â‚ Î£â‚‚ : Î£[ N ]) â†’ [vec]âŒ‰ Î£â‚ âŒˆâ¸¢ `âˆ â¸£ â¨° Î£â‚‚ â‰¡ âŸ¨ 0 âŸ© âˆ¨  [vec]âŒ‰ Î£â‚ âŒˆâ¸¢ `âˆ â¸£ â¨° Î£â‚‚ â‰¡ `âˆ
  L7 : âˆ€ {N} {Î³â‚ Î³â‚‚ : Î³[ N ]} {Î£ : Î£[ N ]} {â„¾ : â„¾[ N ]} {x : idx N }
    â†’ âŸ¨ Î³â‚ , Î³â‚‚ âŸ©âˆˆğ’¢âŸ¦ Î£ Ë â„¾ âŸ§
    â†’ (Îµâ‚ : âŠ¢ Î³â‚ #[ x ] â¦‚ â„¾ #[ x ])
    â†’ (Îµâ‚‚ : âŠ¢ Î³â‚‚ #[ x ] â¦‚ â„¾ #[ x ])
    â†’ âŸ¨ Î³â‚ #[ x ] , Î³â‚‚ #[ x ] âŸ©âˆˆğ’±â€²âŸ¦ â„¾ #[ x ] Ë Îµâ‚ , Îµâ‚‚ Ë Î£ #[ x ] âŸ§
  typeSafety : âˆ€ {N} {e : Term N} {Î“ : Î“[ N ]} {Î£ Î£â€² : Î£[ N ]} {v} {Î³ : Î³[ N ]} {Ï„ : Ï„ N} â†’ Î“ âŠ¢ e â¦‚ Ï„ , Î£ â†’ Î³ âŠ¢ e â‡“ v â†’ âŠ¢ v â¦‚ Î£â€² âŸ¨âŸ¨ Ï„ âŸ©âŸ©
  L8 : âˆ€ {N} {s} {Î£ : Î£[ N ]} {Ï„ v} â†’ (âŠ¢ v â¦‚ (substSx/Ï„ s (â‡§áµ— (â‡§Ë¢ Î£ âŸ¨âŸ¨ Ï„ âŸ©âŸ©)))) â†’ (âŠ¢ v â¦‚ ((s âˆ· Î£) âŸ¨âŸ¨ Ï„ âŸ©âŸ©))
  -- L9-1 : âˆ€ {N} (Î£ : Î£[ N ]) (Ï„ : Ï„ (êœ± N)) â†’ (substSx/Ï„ s (â‡§áµ— (â‡§Ë¢ Î£ âŸ¨âŸ¨ Ï„ âŸ©âŸ©))) â‰¡ (s âˆ· Î£) âŸ¨âŸ¨ Ï„ âŸ©âŸ©
  L9 : âˆ€ {N} (s : Sens) (Î£ : Î£[ N ]) (Ï„ : Ï„ (êœ± N)) â†’ (substSx/Ï„ s (â‡§áµ— (â‡§Ë¢ Î£ âŸ¨âŸ¨ Ï„ âŸ©âŸ©))) â‰¡ (s âˆ· Î£) âŸ¨âŸ¨ Ï„ âŸ©âŸ©
  -- ??
  L10 : âˆ€ {v Ï„â‚ sâ‚ sâ‚‚ Ï„â‚‚} â†’ âŠ¢ (inl v) â¦‚ Ï„â‚ âˆ¥ sâ‚ âˆ” zero âŠ• sâ‚‚ âˆ” zero âˆ¥ Ï„â‚‚ â†’ âŠ¢ v â¦‚ Ï„â‚
  L11 : âˆ€ {v Ï„â‚ sâ‚ sâ‚‚ Ï„â‚‚} â†’ âŠ¢ (inr v) â¦‚ Ï„â‚ âˆ¥ sâ‚ âˆ” zero âŠ• sâ‚‚ âˆ” zero âˆ¥ Ï„â‚‚ â†’ âŠ¢ v â¦‚ Ï„â‚‚
  L12 : âˆ€ {vâ‚ vâ‚‚ Ï„â‚ Ï„â‚‚ sâ‚ sâ‚‚ sâ‚ƒ Îµâ‚ Îµâ‚‚ } â†’ âŸ¨ inl vâ‚ , inl vâ‚‚ âŸ©âˆˆğ’±â€²âŸ¦ Ï„â‚ âˆ¥ sâ‚ âˆ” [] âŠ• sâ‚‚ âˆ” [] âˆ¥ Ï„â‚‚ Ë âŠ¢inl Îµâ‚ , âŠ¢inl Îµâ‚‚ Ë sâ‚ƒ âŸ§
    â†’ âŸ¨ vâ‚ , vâ‚‚ âŸ©âˆˆğ’±â€²âŸ¦ Ï„â‚ Ë Îµâ‚ , Îµâ‚‚ Ë sâ‚ƒ + sâ‚ âŸ§
  -- --
  L13 : âˆ€ {N} {râ‚â‚ râ‚â‚‚ râ‚‚â‚ râ‚‚â‚‚ : â„•} {Î£â‚ Î£â‚‚ Î£â€² : Î£[ N ]} â†’ [vec]âŒ‰ (Î£â‚ + Î£â‚‚) âŒˆâ¸¢ `âˆ â¸£ â¨° Î£â€² â‰¡ âŸ¨ 0 âŸ©
    â†’ âŸ¨ âˆ£ râ‚â‚ - râ‚‚â‚ âˆ£ âŸ© â‰¤ (Î£â‚ â¨° Î£â€²)
    â†’ âŸ¨ âˆ£ râ‚â‚‚ - râ‚‚â‚‚ âˆ£ âŸ© â‰¤ (Î£â‚‚ â¨° Î£â€²)
    â†’ âŸ¨ âˆ£ râ‚â‚ Ã—á´º râ‚â‚‚ - râ‚‚â‚ Ã—á´º râ‚‚â‚‚ âˆ£ âŸ© â‰¡< qty â„• > âŸ¨ 0 âŸ©
  L14 : âˆ€ {N} {Î³ : Î³[ N ]} {Î£â€²} {â„¾â‚ : Î“[ N ]} {â„¾â‚‚ : â„¾[ N ]} â†’ mapâ±½ (instantiateÎ£/Ï„ Î£â€²) â„¾â‚ âŠ¢ Î³ â†’ â„¾â‚‚ âŠ¢ Î³ â†’ mapâ±½ (instantiateÎ£/Ï„ Î£â€²) â„¾â‚ â‰¡ â„¾â‚‚
  L14-1 : âˆ€ {N} {Î³ : Î³[ N ]} {Î£â€²} {â„¾â‚ â„¾â‚‚ : Î“[ N ]} â†’ mapâ±½ (instantiateÎ£/Ï„ Î£â€²) â„¾â‚ âŠ¢ Î³ â†’ mapâ±½ (instantiateÎ£/Ï„ Î£â€²) â„¾â‚‚ âŠ¢ Î³ â†’ â„¾â‚ â‰¡ â„¾â‚‚
  L14-2 : âˆ€ {N} {Î³ : Î³[ N ]} {â„¾â‚ â„¾â‚‚ : â„¾[ N ]} â†’ â„¾â‚ âŠ¢ Î³ â†’ â„¾â‚‚ âŠ¢ Î³ â†’ â„¾â‚ â‰¡ â„¾â‚‚
  L15 : âˆ€ {N} {Î³â‚ Î³â‚‚ : Î³[ N ]} {â„¾ : â„¾[ N ]} {Î“â‚ Î“â‚‚} {Î£â‚ Î£â‚‚ Î£â‚ƒ : Î£[ N ]} â†’ â„¾ âŠ¢ Î³â‚ â†’ â„¾ âŠ¢ Î³â‚‚
    â†’ mapâ±½ (instantiateÎ£/Ï„ Î£â‚) Î“â‚ âŠ¢ Î³â‚
    â†’ mapâ±½ (instantiateÎ£/Ï„ Î£â‚‚) Î“â‚‚ âŠ¢ Î³â‚‚
    â†’ âŸ¨ Î³â‚ , Î³â‚‚ âŸ©âˆˆğ’¢âŸ¦ Î£â‚ƒ Ë â„¾ âŸ§
    â†’ Î“â‚ â‰¡ Î“â‚‚
