{-# OPTIONS --allow-unsolved-metas #-}
module post where

open import rules public
open import logical-relations public

postulate
  L0-1 : âˆ€ {N} (Î£ : Î£[ N ]) â†’ zero â¨° Î£ â‰¡< qty â„• > âŸ¨ 0 âŸ©
  L0-2 : âˆ€ (s : Sens) â†’ âŸ¨ 0 âŸ© Ã—[qty] s â‰¡< qty â„• > âŸ¨ 0 âŸ©
  L0-3 : âˆ€ (s : Sens) â†’ âŸ¨ 0 âŸ© +[qty] s â‰¡< qty â„• > s
  L0-4 : âˆ€ (s : Sens) â†’ (s +[qty] âŸ¨ 0 âŸ©) â‰¡< qty â„• > s
  L0-4â€² : âˆ€ (s : Sens) â†’ s â‰¡< qty â„• > s +[qty] âŸ¨ 0 âŸ©
  L0-5 : âˆ€ {N} (Î£â‚ : Î£[ N ]) (Î£â‚‚ : Î£[ êœ± N ]) â†’ ((âŸ¨ 0 âŸ© âˆ· Î£â‚ â¨° Î£â‚‚) +[qty] âŸ¨ 0 âŸ©) â‰¡ (âŸ¨ 0 âŸ© âˆ· Î£â‚ â¨° Î£â‚‚)
  L0-6 : âˆ€ {N} (s : Sens) (Î£ Î£â€² : Î£[ N ]) â†’ mapâ±½ (_Ã—[qty]_ s) Î£ â¨° Î£â€² â‰¡ s Ã—[qty] (Î£ â¨° Î£â€²)
  L1 : âˆ€ (N : â„•) â†’ âˆ£ N - N âˆ£ â‰¡ 0
  L2 : âˆ€ (N : â„•) â†’ âŸ¨ âˆ£ N - N âˆ£ âŸ© â‰¡< qty â„• > âŸ¨ 0 âŸ©
  L3 : âˆ€ {a b c d N : â„•} {Î£â‚ Î£â‚‚ Î£â‚ƒ : Î£[ N ]} â†’ âŸ¨ âˆ£ a - b âˆ£ âŸ© â‰¤ (Î£â‚ â¨° Î£â‚ƒ) â†’ âŸ¨ âˆ£ c - d âˆ£ âŸ© â‰¤ (Î£â‚‚ â¨° Î£â‚ƒ) â†’ âŸ¨ âˆ£ (a + c) - (b + d) âˆ£ âŸ© â‰¤ ((Î£â‚ + Î£â‚‚) â¨° Î£â‚ƒ)
  L4 : âˆ€ {N} (Î£â‚ Î£â‚‚ Î£â‚ƒ : Î£[ N ]) â†’ (Î£â‚ â¨° Î£â‚ƒ) + (Î£â‚‚ â¨° Î£â‚ƒ) â‰¡ ((Î£â‚ + Î£â‚‚) â¨° Î£â‚ƒ)
  -- L4-1 : âˆ€ {N} (Î£â‚ Î£â‚‚ Î£â‚ƒ : Î£[ N ]) â†’ (Î£â‚ â¨° Î£â‚ƒ) + (Î£â‚‚ â¨° Î£â‚ƒ) â‰¡ ((Î£â‚ + Î£â‚‚) â¨° Î£â‚ƒ)
  L5 : âˆ€ {N} (Î£â‚ Î£â‚‚ : Î£[ N ]) â†’ (Î£â‚ â¨° Î£â‚‚) â‰¡ (Î£â‚‚ â¨° Î£â‚)
  L5â€² : âˆ€ (Î£â‚ Î£â‚‚ : Sens) â†’ (Î£â‚ +[qty] Î£â‚‚) â‰¡ (Î£â‚‚ +[qty] Î£â‚)
  L6 : âˆ€ {N} (Î£â‚ Î£â‚‚ : Î£[ N ]) â†’ [vec]âŒ‰ Î£â‚ âŒˆâ¸¢ `âˆ â¸£ â¨° Î£â‚‚ â‰¡ âŸ¨ 0 âŸ© âˆ¨  [vec]âŒ‰ Î£â‚ âŒˆâ¸¢ `âˆ â¸£ â¨° Î£â‚‚ â‰¡ `âˆ
  L7 : âˆ€ {N} {Î³â‚ Î³â‚‚ : Î³[ N ]} {Î£ : Î£[ N ]} {â„¾ : â„¾[ N ]} {x : idx N }
    â†’ âŸ¨ Î³â‚ , Î³â‚‚ âŸ©âˆˆğ’¢âŸ¦ Î£ Ë â„¾ âŸ§
    â†’ (Îµâ‚ : âŠ¢ Î³â‚ #[ x ] â¦‚ â„¾ #[ x ])
    â†’ (Îµâ‚‚ : âŠ¢ Î³â‚‚ #[ x ] â¦‚ â„¾ #[ x ])
    â†’ âŸ¨ Î³â‚ #[ x ] , Î³â‚‚ #[ x ] âŸ©âˆˆğ’±â€²âŸ¦ â„¾ #[ x ] Ë Îµâ‚ , Îµâ‚‚ Ë Î£ #[ x ] âŸ§
  typeSafety : âˆ€ {N} {e : Term N} {Î“ : Î“[ N ]} {Î£ Î£â€² : Î£[ N ]} {v} {Î³ : Î³[ N ]} {Ï„ : Ï„ N} â†’ Î“ âŠ¢ e â¦‚ Ï„ , Î£ â†’ Î³ âŠ¢ e â‡“ v â†’ âŠ¢ v â¦‚ Î£â€² âŸ¨âŸ¨ Ï„ âŸ©âŸ©
  L8 : âˆ€ {N} {s} {Î£ : Î£[ N ]} {Ï„ v} â†’ (âŠ¢ v â¦‚ (substSx/Ï„ s (â‡§áµ— (â‡§Ë¢ Î£ âŸ¨âŸ¨ Ï„ âŸ©âŸ©)))) â†’ (âŠ¢ v â¦‚ ((s âˆ· Î£) âŸ¨âŸ¨ Ï„ âŸ©âŸ©))
  -- L9-1 : âˆ€ {N} (Î£ : Î£[ N ]) (Ï„ : Ï„ (êœ± N)) â†’ (substSx/Ï„ s (â‡§áµ— (â‡§Ë¢ Î£ âŸ¨âŸ¨ Ï„ âŸ©âŸ©))) â‰¡ (s âˆ· Î£) âŸ¨âŸ¨ Ï„ âŸ©âŸ©
  L9 : âˆ€ {N} (s : Sens) (Î£ : Î£[ N ]) (Ï„ : Ï„ (êœ± N)) â†’ (substSx/Ï„ s (â‡§áµ— (â‡§Ë¢ Î£ âŸ¨âŸ¨ Ï„ âŸ©âŸ©))) â‰¡ (s âˆ· Î£) âŸ¨âŸ¨ Ï„ âŸ©âŸ©
  L13 : âˆ€ {N} {râ‚â‚ râ‚â‚‚ râ‚‚â‚ râ‚‚â‚‚ : â„•} {Î£â‚ Î£â‚‚ Î£â€² : Î£[ N ]} â†’ [vec]âŒ‰ (Î£â‚ + Î£â‚‚) âŒˆâ¸¢ `âˆ â¸£ â¨° Î£â€² â‰¡ âŸ¨ 0 âŸ©
    â†’ âŸ¨ âˆ£ râ‚â‚ - râ‚‚â‚ âˆ£ âŸ© â‰¤ (Î£â‚ â¨° Î£â€²)
    â†’ âŸ¨ âˆ£ râ‚â‚‚ - râ‚‚â‚‚ âˆ£ âŸ© â‰¤ (Î£â‚‚ â¨° Î£â€²)
    â†’ âŸ¨ âˆ£ râ‚â‚ Ã—á´º râ‚â‚‚ - râ‚‚â‚ Ã—á´º râ‚‚â‚‚ âˆ£ âŸ© â‰¡< qty â„• > âŸ¨ 0 âŸ©
  L14 : âˆ€ {N} {Î³ : Î³[ N ]} {Î£â€²} {â„¾â‚ : Î“[ N ]} {â„¾â‚‚ : â„¾[ N ]} â†’ mapâ±½ (instantiateÎ£/Ï„ Î£â€²) â„¾â‚ âŠ¢ Î³ â†’ â„¾â‚‚ âŠ¢ Î³ â†’ mapâ±½ (instantiateÎ£/Ï„ Î£â€²) â„¾â‚ â‰¡ â„¾â‚‚
  L14-1 : âˆ€ {N} {Î³ : Î³[ N ]} {Î£â€²} {â„¾â‚ â„¾â‚‚ : Î“[ N ]} â†’ mapâ±½ (instantiateÎ£/Ï„ Î£â€²) â„¾â‚ âŠ¢ Î³ â†’ mapâ±½ (instantiateÎ£/Ï„ Î£â€²) â„¾â‚‚ âŠ¢ Î³ â†’ â„¾â‚ â‰¡ â„¾â‚‚
  L14-2 : âˆ€ {N} {Î³ : Î³[ N ]} {â„¾â‚ â„¾â‚‚ : â„¾[ N ]} â†’ â„¾â‚ âŠ¢ Î³ â†’ â„¾â‚‚ âŠ¢ Î³ â†’ â„¾â‚ â‰¡ â„¾â‚‚
  L15 : âˆ€ {N} {Î³â‚ Î³â‚‚ : Î³[ N ]} {â„¾ : â„¾[ N ]} {Î“â‚ Î“â‚‚} {Î£â‚ : Î£[ N ]} â†’ â„¾ âŠ¢ Î³â‚ â†’ â„¾ âŠ¢ Î³â‚‚
    â†’ mapâ±½ (instantiateÎ£/Ï„ Î£â‚) Î“â‚ âŠ¢ Î³â‚
    â†’ mapâ±½ (instantiateÎ£/Ï„ Î£â‚) Î“â‚‚ âŠ¢ Î³â‚‚
    â†’ Î“â‚ â‰¡ Î“â‚‚
  L16 : âˆ€ {N} (sâ‚‚ sâ‚ƒ : Sens) (Î£â‚ Î£â‚â‚ Î£â‚â‚‚ Î£â‚‚ Î£â‚ƒ Î£â€² : Î£[ N ])
    â†’ Î£â‚ â¨° Î£â€² â‰¡ `âˆ
    â†’ ([vec]âŒ‰ Î£â‚ âŒˆâ¸¢ `âˆ â¸£ + ((sâ‚‚ â¨µ Î£â‚â‚) + Î£â‚‚) âŠ” ((sâ‚ƒ â¨µ Î£â‚â‚‚) + Î£â‚ƒ)) â¨° Î£â€² â‰¡ `âˆ
  L17 : âˆ€ {N} {vâ‚ vâ‚‚ Ï„} {Î£ : Î£[ N ]} â†’ (Îµâ‚ : âŠ¢ vâ‚ â¦‚ Î£ âŸ¨âŸ¨ Ï„ âŸ©âŸ©)
    â†’ (Îµâ‚‚ : âŠ¢ vâ‚‚ â¦‚ Î£ âŸ¨âŸ¨ Ï„ âŸ©âŸ©)
    â†’ âŸ¨ vâ‚ , vâ‚‚ âŸ©âˆˆğ’±â€²âŸ¦ Î£ âŸ¨âŸ¨ Ï„ âŸ©âŸ© Ë Îµâ‚ , Îµâ‚‚ Ë `âˆ âŸ§
  L18 : âˆ€ {N} (Î£â€² : Î£[ N ]) (Ï„â‚‚ Ï„â‚ƒ Ï„â‚ : Ï„ (êœ± N))
    â†’ â‡§áµ—< á´¢ > (â‡§Ë¢ Î£â€² âŸ¨âŸ¨ Ï„â‚‚ âŸ©âŸ©) â‰¡ instantiateÎ£/Ï„ ğŸ Ï„â‚ƒ
    â†’ â‡§áµ—< á´¢ > (â‡§Ë¢ Î£â€² âŸ¨âŸ¨ Ï„â‚‚ âŸ©âŸ©) â‰¡ instantiateÎ£/Ï„ ğŸ Ï„â‚
    â†’ Ï„â‚ â‰¡ Ï„â‚ƒ
  L19 : âˆ€ {N} (Î£â€² : Î£[ N ]) (Ï„â‚ƒ Ï„â‚‚ Ï„â‚ : Ï„ N)
    â†’ (Î£â€² âŸ¨âŸ¨ Ï„â‚ âŸ©âŸ©) â‰¡ instantiateÎ£/Ï„ (ğœ< N > âŸ¨ 0 âŸ©) Ï„â‚ƒ
    â†’ (Î£â€² âŸ¨âŸ¨ Ï„â‚ âŸ©âŸ©) â‰¡ instantiateÎ£/Ï„ (ğœ< N > âŸ¨ 0 âŸ©) Ï„â‚‚
    â†’ Ï„â‚ƒ â‰¡ Ï„â‚‚
  L20 : âˆ€ {N} {Ï„â‚ â„¾ Î£â‚ Î£â‚‚ Ï„â‚‚ s} {e : Term (êœ± N)} â†’ â‡§áµ—< á´¢ > Ï„â‚ âˆ· mapâ±½ â‡§áµ—< á´¢ > â„¾ âŠ¢ e â¦‚ Ï„â‚‚ , s âˆ· Î£â‚
    â†’ â‡§áµ—< á´¢ > Ï„â‚ âˆ· mapâ±½ â‡§áµ—< á´¢ > â„¾ âŠ¢ e â¦‚ Ï„â‚‚ , s âˆ· Î£â‚‚
    â†’ Î£â‚ â‰¡ Î£â‚‚
  L21 : âˆ€ {N} {Î³â‚ Î³â€²â‚ : Î³[ N ]} {e eâ€²} â†’ Î³â‚ âŠ¢ e â‡“ (Æ›â¦‚ eâ€² âˆ¥ Î³â€²â‚) â†’ Î³â‚ â‰¡ Î³â€²â‚
  L21-1 : âˆ€ {N} {Î³â€²â‚ : Î³[ N ]} {eâ‚ eâ€²â‚ Î³â€²â‚‚} {eâ€²â‚‚} â†’  Î³â€²â‚ âŠ¢ eâ‚ â‡“ (Æ›â¦‚ eâ€²â‚ âˆ¥ Î³â€²â‚) â†’ Î³â€²â‚‚ âŠ¢ eâ‚ â‡“ (Æ›â¦‚ eâ€²â‚‚ âˆ¥ Î³â€²â‚‚) â†’ eâ€²â‚ â‰¡ eâ€²â‚‚
  L22 : âˆ€ {N} â†’ (Î£â‚‚ Î£â€² : Î£[ N ]) â†’ (Ï„ : Ï„ (êœ± N)) â†’  (Î£â€² âŸ¨âŸ¨ substÎ£/Ï„ á´¢ Î£â‚‚ Ï„ âŸ©âŸ©) â‰¡ substSx/Ï„< á´¢ > (Î£â‚‚ â¨° Î£â€²) (â‡§áµ—< á´¢ > ((âŸ¨ 0 âŸ© âˆ· Î£â€²) âŸ¨âŸ¨ Ï„ âŸ©âŸ©))
  subsumption : âˆ€ {N} {Ï„ Ï„â‚ Ï„â‚‚ vâ‚ vâ‚‚  Î£â€² } {sâ‚‚ sâ‚ƒ Îµâ‚ Îµâ‚‚ Îµâ‚ƒ Îµâ‚„} {Î£â‚ Î£â‚â‚ Î£â‚â‚‚ Î£â‚‚ Î£â‚ƒ : Î£[ N ]}  â†’ (Ï„â‚ Ï„[âŠ”] Ï„â‚‚) â‰¡ âŸ¨ Ï„ âŸ©
    â†’ âŸ¨ vâ‚ , vâ‚‚ âŸ©âˆˆğ’±â€²âŸ¦ (Î£â€² âŸ¨âŸ¨ Ï„â‚ âŸ©âŸ©) Ë Îµâ‚ƒ , Îµâ‚„ Ë (sâ‚‚ Ã—[qty] ((Î£â‚ â¨° Î£â€²) +[qty] (âŸ¨ 0 âŸ© +[qty] (Î£â€² â¨° Î£â‚â‚)))) +[qty] (Î£â‚‚ â¨° Î£â€²)âŸ§
    â†’ âŸ¨ vâ‚ , vâ‚‚ âŸ©âˆˆğ’±â€²âŸ¦ (Î£â€² âŸ¨âŸ¨ Ï„ âŸ©âŸ©) Ë Îµâ‚ , Îµâ‚‚ Ë (([vec]âŒ‰ Î£â‚ âŒˆâ¸¢ `âˆ â¸£ + ((sâ‚‚ â¨µ Î£â‚â‚) + Î£â‚‚) âŠ” ((sâ‚ƒ â¨µ Î£â‚â‚‚) + Î£â‚ƒ)) â¨° Î£â€²)âŸ§
