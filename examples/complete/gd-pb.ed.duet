-- the command line interface we want
--
--     `duet run <this-file> "data.csv" "labels.csv" 0.05 100 0.0001 0.0001 1`
--
-- gradient descent
-- per-iteration bound
let main = pλ m  : ℕ,
              n  : ℕ,
              ε  : ℝ⁺,
              k  : ℕ,
              δ  : ℝ⁺,
              δ′ : ℝ⁺
              .
              xs : 𝕄 [L∞, U|m, n⋅𝔻 ] ,
              ys : 𝕄 [L∞, U|m, 1⋅𝔻 ] ,
              ε  : ℝ⁺[ε],
              k  : ℕ[k],
              δ  : ℝ⁺[δ],
              δ′ : ℝ⁺[δ′],
              η  : ℝ
              ⇒
  let m₀ = mcreate @ 1 @ n @ 𝔻 ℕ[1] ℕ[n] (sλ . i : 𝕀[m] , j : 𝕀[n] ⇒ 0.0) in
  aloop @ ε @ δ @ δ′ @ k @ <xs,ys>@<θ>
    (pλ θ : 𝕄 [L∞, U|ℕ[1], n⋅𝔻 ] ⇒
      g ← mgauss[ s , ε , δ ] <xs,ys> { ∇[ LR | θ ; mclip[L2] xs , ys ] } ;
      return (myMatSub @ m @ n θ g))
    m₀
    δ′
in main
