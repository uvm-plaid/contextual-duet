-- gradient descent
-- per-iteration bound
-- with minibatching
let main = âˆ€  m  : â„•,
              n  : â„•,
              Îµ  : â„âº,
              k  : â„•,
              Î´  : â„âº,
              Î´â€² : â„âº,
              b  : â„•
              .
          pÎ»  xs : ğ•„ [Lâˆ, U|m, nâ†¦ğ”» ] â‹… 1.0 ,
              ys : ğ•„ [Lâˆ, U|m, 1.0â†¦ğ”» ] â‹… 1.0 ,
              Îµ  : â„âº[Îµ] â‹… 1.0,
              k  : â„•[k] â‹… 1.0,
              Î´  : â„âº[Î´] â‹… 1.0,
              Î´â€² : â„âº[Î´â€²] â‹… 1.0,
              Î·  : â„ â‹… 1.0,
              b  : â„•[b] â‹… 1.0
              â‡’
  let d = mcols @ m @ n @ ğ”» xs in
  let mâ‚€ = mcreate @ â„•[1.0] @ â„•[n] @ â„ â„•[1] d (sÎ» i : ğ•€[1.0] , j : ğ•€[n] â‡’ 0.0) in
  aloop @ â„âº[2.0â‹…(b/m)â‹…Îµ] @ â„âº[(b/m)â‹…Î´] @ Î´â€² @ k @ n @ <xs,ys>
    (pÎ» <xs,ys> Î¸ : ğ•„ [Lâˆ, U|1.0, nâ†¦ğ”» ] â‹… 1.0 â‡’
      g â† sample @ Îµ @ Î´ @ b @ m @ n @ ğ•„ [Lâˆ, U|1.0, nâ†¦â„ ] b
        (pÎ» <xs',ys'> xs' : ğ•„ [Lâˆ, U|b, nâ†¦ğ”» ] â‹… 1.0, <xs',ys'> ys' : ğ•„ [Lâˆ, U|b, 1.0â†¦ğ”» ] â‹… 1.0  â‡’
          mgauss @ Îµ @ Î´ @ â„•[1.0] @ n Îµ Î´
            (mLipGrad @ b @ n Î¸ (mclip @ b @ n @ ğ”» xs') ys'))
        (mclip @ m @ n @ ğ”» xs) ys;
      return (matsub @ â„•[1.0] @ n Î¸ g))
    mâ‚€
    Î´â€²

in main
