{-# OPTIONS --allow-unsolved-metas #-}
module red-proof where

open import rules public
-- open import lemmas public
open import logical-relations public

postulate
  typeSafety : âˆ€ {N} {e : Term N} {Î“ : Î“[ N ]} {Î£ Î£â€² Î£â‚€ : Î£[ N ]} {v} {Î³ : Î³[ N ]} {Ï„ : Ï„ N} â†’ Î“ , Î£â‚€ âŠ¢ e â¦‚ Ï„ , Î£ â†’ Î³ âŠ¢ e â‡“ v â†’ âŠ¢ v â¦‚ Î£â€² âŸ¨âŸ¨ Ï„ âŸ©âŸ©
  fp : âˆ€ {N} {Î“ : Î“[ N ]} {â„¾ e Ï„ Î£ Î³â‚ Î³â‚‚ Î£â€² Î£â‚€} â†’ â„¾ âŠ¢ Î³â‚ â†’ â„¾ âŠ¢ Î³â‚‚ â†’ Î“ , Î£â‚€ âŠ¢ e â¦‚ Ï„ , Î£ â†’ âŸ¨ Î³â‚ , Î³â‚‚ âŸ©âˆˆğ’¢âŸ¦ Î£â€² Ë â„¾ âŸ§ â†’ âŸ¨ Î³â‚ âŠ¢ e , Î³â‚‚ âŠ¢ e âŸ©âˆˆâ„°âŸ¦ Î£ â¨° Î£â€² Ë (Î£â€² âŸ¨âŸ¨ Ï„ âŸ©âŸ©) âŸ§

-- Theorem 1.1.2 (Fundamental Property / (Metric Preservation in Fuzz)).
fpâ‚‚ : âˆ€ {N} {Î“ : Î“[ N ]} {â„¾ e Ï„ Î£ Î£â‚€ Î³â‚ Î³â‚‚ Î£â€²} â†’ â„¾ âŠ¢ Î³â‚ â†’ â„¾ âŠ¢ Î³â‚‚
  â†’ Î“ , Î£â‚€ âŠ¢â‚š e â¦‚ Ï„ , Î£
  â†’ âŸ¨ Î³â‚ , Î³â‚‚ âŸ©âˆˆğ’¢âŸ¦ Î£â€² Ë â„¾ âŸ§
  â†’ âŸ¨ Î³â‚ âŠ¢ e , Î³â‚‚ âŠ¢ e âŸ©âˆˆâ„°â‚šâŸ¦ L1N Î£ Ë (Î£â€² âŸ¨âŸ¨ Ï„ âŸ©âŸ©) âŸ§
fpâ‚‚ âŠ¢Î³â‚ âŠ¢Î³â‚‚ (âŠ¢`papp {Î£â‚ = Î£â‚} {Î£â‚‚ = Î£â‚‚} {p = p} eâ‚ eâ‚‚) r[Î³â‚,Î³â‚‚] vâ‚ vâ‚‚ râ‚ râ‚‚ Îµâ‚ Îµâ‚‚ âŸ¨ âŠ¢`papp {Î³ = Î³â‚} {eâ€² = eâ€²â‚} {ğ“‹â‚ = ğ“‹â‚} âŠ¢eâ‚â‚ âŠ¢eâ‚â‚‚ âŠ¢eâ‚â‚‚â€² , âŠ¢`papp {Î³ = Î³â‚‚} {eâ€² = eâ€²â‚‚} {ğ“‹â‚ = ğ“‹â‚‚} âŠ¢eâ‚‚â‚ âŠ¢eâ‚‚â‚‚ âŠ¢eâ‚‚â‚‚â€² âŸ© prâ‚ prâ‚‚
  with fp âŠ¢Î³â‚ âŠ¢Î³â‚‚ eâ‚ r[Î³â‚,Î³â‚‚] (pÆ›â¦‚ eâ€²â‚ âˆ¥ Î³â‚) (pÆ›â¦‚ eâ€²â‚‚ âˆ¥ Î³â‚‚) (typeSafety eâ‚ âŠ¢eâ‚â‚) (typeSafety eâ‚ âŠ¢eâ‚‚â‚) âŸ¨ âŠ¢eâ‚â‚ , âŠ¢eâ‚‚â‚ âŸ©
     | fp âŠ¢Î³â‚ âŠ¢Î³â‚‚ eâ‚‚ r[Î³â‚,Î³â‚‚] ğ“‹â‚ ğ“‹â‚‚ (typeSafety eâ‚‚ âŠ¢eâ‚â‚‚) (typeSafety eâ‚‚ âŠ¢eâ‚‚â‚‚) âŸ¨ âŠ¢eâ‚â‚‚ , âŠ¢eâ‚‚â‚‚ âŸ©
... | IHâ‚ | IHâ‚‚ = {!   !}
