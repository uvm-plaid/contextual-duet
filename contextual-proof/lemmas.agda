{-# OPTIONS --allow-unsolved-metas #-}
module lemmas where

open import rules public
open import logical-relations public

L1â€² : âˆ€ (Î£â‚ Î£â‚‚ : Sens) â†’ (Î£â‚ +[qty] Î£â‚‚) â‰¡ (Î£â‚‚ +[qty] Î£â‚)
L1â€² Î£â‚ Î£â‚‚ = commu[+]< Î£â‚ , Î£â‚‚ >

L1 : âˆ€ {N} (Î£â‚ Î£â‚‚ : Î£[ N ]) â†’ (Î£â‚ â¨° Î£â‚‚) â‰¡ (Î£â‚‚ â¨° Î£â‚)
L1 [] [] = â†¯
L1 (x âˆ· a) (xâ‚ âˆ· b) rewrite commu[Ã—]< x , xâ‚ > | L1 a b = â†¯

L0-1 : âˆ€ {N} (Î£ : Î£[ N ]) â†’ zero â¨° Î£ â‰¡< qty â„• > âŸ¨ 0 âŸ©
L0-1 e = lzero[â¨°]< e >

L0-3 : âˆ€ (s : Sens) â†’ âŸ¨ 0 âŸ© +[qty] s â‰¡< qty â„• > s
L0-3 âŸ¨ x âŸ© = â†¯
L0-3 `âˆ = â†¯

L0-3â€² : âˆ€ (s : Sens) â†’ s â‰¡< qty â„• > âŸ¨ 0 âŸ© +[qty] s
L0-3â€² s = â—‡ (lunit[+][qty]< s >)

L0-4 : âˆ€ (s : Sens) â†’ (s +[qty] âŸ¨ 0 âŸ©) â‰¡< qty â„• > s
L0-4 s = runit[+][qty]< s >

L0-4â€² : âˆ€ (s : Sens) â†’ s â‰¡< qty â„• > s +[qty] âŸ¨ 0 âŸ©
L0-4â€² s = â—‡ (runit[+][qty]< s >)

L0-5 : âˆ€ {N} (Î£â‚ : Î£[ N ]) (Î£â‚‚ : Î£[ êœ± N ]) â†’ ((âŸ¨ 0 âŸ© âˆ· Î£â‚ â¨° Î£â‚‚) +[qty] âŸ¨ 0 âŸ©) â‰¡ (âŸ¨ 0 âŸ© âˆ· Î£â‚ â¨° Î£â‚‚)
L0-5 Î£â‚ Î£â‚‚ = runit[+][qty]< (âŸ¨ 0 âŸ© âˆ· Î£â‚ â¨° Î£â‚‚) >

L0-7 : âˆ€ (sâ‚ sâ‚‚ : Sens) â†’ (sâ‚ +[qty] sâ‚‚) â‰¡< qty â„• > (sâ‚‚ +[qty] sâ‚)
L0-7 sâ‚ sâ‚‚ = commu[+]< sâ‚ , sâ‚‚ >

postulate
  L0-2 : âˆ€ (s : Sens) â†’ âŸ¨ 0 âŸ© Ã—[qty] s â‰¡< qty â„• > âŸ¨ 0 âŸ©
  L0-6 : âˆ€ {N} (s : Sens) (Î£ Î£â€² : Î£[ N ]) â†’ mapâ±½ (_Ã—[qty]_ s) Î£ â¨° Î£â€² â‰¡ s Ã—[qty] (Î£ â¨° Î£â€²)
  L0-8 : âˆ€ (N : â„•) â†’ âŸ¨ âˆ£ N - N âˆ£ âŸ© â‰¡< qty â„• > âŸ¨ 0 âŸ©
  â–µ : âˆ€ {a b c d N : â„•} {Î£â‚ Î£â‚‚ Î£â‚ƒ : Î£[ N ]} â†’ âŸ¨ âˆ£ a - b âˆ£ âŸ© â‰¤ (Î£â‚ â¨° Î£â‚ƒ) â†’ âŸ¨ âˆ£ c - d âˆ£ âŸ© â‰¤ (Î£â‚‚ â¨° Î£â‚ƒ) â†’ âŸ¨ âˆ£ (a + c) - (b + d) âˆ£ âŸ© â‰¤ ((Î£â‚ + Î£â‚‚) â¨° Î£â‚ƒ)
  L0-9 : âˆ€ {N} (Î£â‚ Î£â‚‚ Î£â‚ƒ : Î£[ N ]) â†’ (Î£â‚ â¨° Î£â‚ƒ) + (Î£â‚‚ â¨° Î£â‚ƒ) â‰¡ ((Î£â‚ + Î£â‚‚) â¨° Î£â‚ƒ)
  truncDichotomy : âˆ€ {N} (Î£â‚ Î£â‚‚ : Î£[ N ]) â†’ [vec]âŒ‰ Î£â‚ âŒˆâ¸¢ `âˆ â¸£ â¨° Î£â‚‚ â‰¡ âŸ¨ 0 âŸ© âˆ¨ [vec]âŒ‰ Î£â‚ âŒˆâ¸¢ `âˆ â¸£ â¨° Î£â‚‚ â‰¡ `âˆ
  gammaVarValRel : âˆ€ {N} {Î³â‚ Î³â‚‚ : Î³[ N ]} {Î£ : Î£[ N ]} {â„¾ : â„¾[ N ]} {x : idx N }
    â†’ âŸ¨ Î³â‚ , Î³â‚‚ âŸ©âˆˆğ’¢âŸ¦ Î£ Ë â„¾ âŸ§
    â†’ (Îµâ‚ : âŠ¢ Î³â‚ #[ x ] â¦‚ â„¾ #[ x ])
    â†’ (Îµâ‚‚ : âŠ¢ Î³â‚‚ #[ x ] â¦‚ â„¾ #[ x ])
    â†’ âŸ¨ Î³â‚ #[ x ] , Î³â‚‚ #[ x ] âŸ©âˆˆğ’±â€²âŸ¦ â„¾ #[ x ] Ë Îµâ‚ , Îµâ‚‚ Ë Î£ #[ x ] âŸ§
  L2 : âˆ€ {N} (s : Sens) (Î£ : Î£[ N ]) (Ï„ : Ï„ (êœ± N)) â†’ (substSx/Ï„ s (â‡§áµ— (â‡§Ë¢ Î£ âŸ¨âŸ¨ Ï„ âŸ©âŸ©))) â‰¡ (s âˆ· Î£) âŸ¨âŸ¨ Ï„ âŸ©âŸ©
  â–µÃ— : âˆ€ {N} {râ‚â‚ râ‚â‚‚ râ‚‚â‚ râ‚‚â‚‚ : â„•} {Î£â‚ Î£â‚‚ Î£â€² : Î£[ N ]} â†’ [vec]âŒ‰ (Î£â‚ + Î£â‚‚) âŒˆâ¸¢ `âˆ â¸£ â¨° Î£â€² â‰¡ âŸ¨ 0 âŸ©
    â†’ âŸ¨ âˆ£ râ‚â‚ - râ‚‚â‚ âˆ£ âŸ© â‰¤ (Î£â‚ â¨° Î£â€²)
    â†’ âŸ¨ âˆ£ râ‚â‚‚ - râ‚‚â‚‚ âˆ£ âŸ© â‰¤ (Î£â‚‚ â¨° Î£â€²)
    â†’ âŸ¨ âˆ£ râ‚â‚ Ã—á´º râ‚â‚‚ - râ‚‚â‚ Ã—á´º râ‚‚â‚‚ âˆ£ âŸ© â‰¡< qty â„• > âŸ¨ 0 âŸ©
  L3 : âˆ€ {N} {e eâ€²â‚ eâ€²â‚‚} {Î³â‚ Î³â‚‚ : Î³[ N ]} {â„¾ : â„¾[ N ]} {Î“â‚ Î“â‚‚} {Î£â‚ : Î£[ N ]}
    â†’ Î³â‚ âŠ¢ e â‡“ (Æ›â¦‚ eâ€²â‚ âˆ¥ Î³â‚)
    â†’ Î³â‚‚ âŠ¢ e â‡“ (Æ›â¦‚ eâ€²â‚‚ âˆ¥ Î³â‚‚)
    â†’ mapâ±½ (instantiateÎ£/Ï„ Î£â‚) Î“â‚ âŠ¢ Î³â‚
    â†’ mapâ±½ (instantiateÎ£/Ï„ Î£â‚) Î“â‚‚ âŠ¢ Î³â‚‚
    â†’ eâ€²â‚ â‰¡ eâ€²â‚‚ âˆ§ Î“â‚ â‰¡ Î“â‚‚
  L3â€² : âˆ€ {N} {Î³â‚ Î³â‚‚ : Î³[ N ]} {â„¾ : â„¾[ N ]} {Î“} {Î£ : Î£[ N ]}
    â†’ mapâ±½ (instantiateÎ£/Ï„ zero) Î“ âŠ¢ Î³â‚
    â†’ mapâ±½ (instantiateÎ£/Ï„ zero) Î“ âŠ¢ Î³â‚‚
    â†’ âŸ¨ Î³â‚ , Î³â‚‚ âŸ©âˆˆğ’¢âŸ¦ Î£ Ë â„¾ âŸ§
    â†’ âŸ¨ Î³â‚ , Î³â‚‚ âŸ©âˆˆğ’¢âŸ¦ Î£ Ë mapâ±½ (instantiateÎ£/Ï„ Î£) Î“ âŸ§
  L4 : âˆ€ {N} (sâ‚‚ sâ‚ƒ : Sens) (Î£â‚ Î£â‚â‚ Î£â‚â‚‚ Î£â‚‚ Î£â‚ƒ Î£â€² : Î£[ N ])
    â†’ Î£â‚ â¨° Î£â€² â‰¡ `âˆ
    â†’ ([vec]âŒ‰ Î£â‚ âŒˆâ¸¢ `âˆ â¸£ + ((sâ‚‚ â¨µ Î£â‚â‚) + Î£â‚‚) âŠ” ((sâ‚ƒ â¨µ Î£â‚â‚‚) + Î£â‚ƒ)) â¨° Î£â€² â‰¡ `âˆ
  L5 : âˆ€ {N} {vâ‚ vâ‚‚ Ï„} {Î£ : Î£[ N ]} â†’ (Îµâ‚ : âŠ¢ vâ‚ â¦‚ Î£ âŸ¨âŸ¨ Ï„ âŸ©âŸ©)
    â†’ (Îµâ‚‚ : âŠ¢ vâ‚‚ â¦‚ Î£ âŸ¨âŸ¨ Ï„ âŸ©âŸ©)
    â†’ âŸ¨ vâ‚ , vâ‚‚ âŸ©âˆˆğ’±â€²âŸ¦ Î£ âŸ¨âŸ¨ Ï„ âŸ©âŸ© Ë Îµâ‚ , Îµâ‚‚ Ë `âˆ âŸ§
  L6 : âˆ€ {N} (Î£â€² : Î£[ N ]) (Ï„â‚‚ Ï„â‚ƒ Ï„â‚ : Ï„ (êœ± N))
    â†’ â‡§áµ—< á´¢ > (â‡§Ë¢ Î£â€² âŸ¨âŸ¨ Ï„â‚‚ âŸ©âŸ©) â‰¡ instantiateÎ£/Ï„ ğŸ Ï„â‚ƒ
    â†’ â‡§áµ—< á´¢ > (â‡§Ë¢ Î£â€² âŸ¨âŸ¨ Ï„â‚‚ âŸ©âŸ©) â‰¡ instantiateÎ£/Ï„ ğŸ Ï„â‚
    â†’ Ï„â‚ â‰¡ Ï„â‚ƒ
  L7 : âˆ€ {N} (Î£â€² : Î£[ N ]) (Ï„â‚ƒ Ï„â‚‚ Ï„â‚ : Ï„ N)
    â†’ (Î£â€² âŸ¨âŸ¨ Ï„â‚ âŸ©âŸ©) â‰¡ instantiateÎ£/Ï„ (ğœ< N > âŸ¨ 0 âŸ©) Ï„â‚ƒ
    â†’ (Î£â€² âŸ¨âŸ¨ Ï„â‚ âŸ©âŸ©) â‰¡ instantiateÎ£/Ï„ (ğœ< N > âŸ¨ 0 âŸ©) Ï„â‚‚
    â†’ Ï„â‚ƒ â‰¡ Ï„â‚‚
  L8 : âˆ€ {N} {Ï„â‚ â„¾ Î£â‚ Î£â‚‚ Ï„â‚‚ s} {e : Term (êœ± N)}
    â†’ â„¾ âŠ¢ Æ›â¦‚ Ï„â‚ â‡’ e â¦‚ (Æ›â¦‚ Ï„â‚ â‡’[ zero âˆ” s âˆ· Î£â‚ ] Ï„â‚‚) , zero
    â†’ â„¾ âŠ¢ Æ›â¦‚ Ï„â‚ â‡’ e â¦‚ (Æ›â¦‚ Ï„â‚ â‡’[ zero âˆ” s âˆ· Î£â‚‚ ] Ï„â‚‚) , zero
    â†’ Î£â‚ â‰¡ Î£â‚‚
  L9 : âˆ€ {N} â†’ (Î£â‚‚ Î£â€² : Î£[ N ]) â†’ (Ï„ : Ï„ (êœ± N)) â†’  (Î£â€² âŸ¨âŸ¨ substÎ£/Ï„ á´¢ Î£â‚‚ Ï„ âŸ©âŸ©) â‰¡ substSx/Ï„< á´¢ > (Î£â‚‚ â¨° Î£â€²) (â‡§áµ—< á´¢ > ((âŸ¨ 0 âŸ© âˆ· Î£â€²) âŸ¨âŸ¨ Ï„ âŸ©âŸ©))
  typeSafety : âˆ€ {N} {e : Term N} {Î“ : Î“[ N ]} {Î£ Î£â€² : Î£[ N ]} {v} {Î³ : Î³[ N ]} {Ï„ : Ï„ N} â†’ Î“ âŠ¢ e â¦‚ Ï„ , Î£ â†’ Î³ âŠ¢ e â‡“ v â†’ âŠ¢ v â¦‚ Î£â€² âŸ¨âŸ¨ Ï„ âŸ©âŸ©
  subsumption : âˆ€ {N} {Ï„ Ï„â‚ Ï„â‚‚ vâ‚ vâ‚‚  Î£â€² } {sâ‚‚ sâ‚ƒ Îµâ‚ Îµâ‚‚ Îµâ‚ƒ Îµâ‚„} {Î£â‚ Î£â‚â‚ Î£â‚â‚‚ Î£â‚‚ Î£â‚ƒ : Î£[ N ]}  â†’ (Ï„â‚ Ï„[âŠ”] Ï„â‚‚) â‰¡ âŸ¨ Ï„ âŸ©
    â†’ âŸ¨ vâ‚ , vâ‚‚ âŸ©âˆˆğ’±â€²âŸ¦ (Î£â€² âŸ¨âŸ¨ Ï„â‚ âŸ©âŸ©) Ë Îµâ‚ƒ , Îµâ‚„ Ë (sâ‚‚ Ã—[qty] ((Î£â‚ â¨° Î£â€²) +[qty] (âŸ¨ 0 âŸ© +[qty] (Î£â€² â¨° Î£â‚â‚)))) +[qty] (Î£â‚‚ â¨° Î£â€²)âŸ§
    â†’ âŸ¨ vâ‚ , vâ‚‚ âŸ©âˆˆğ’±â€²âŸ¦ (Î£â€² âŸ¨âŸ¨ Ï„ âŸ©âŸ©) Ë Îµâ‚ , Îµâ‚‚ Ë (([vec]âŒ‰ Î£â‚ âŒˆâ¸¢ `âˆ â¸£ + ((sâ‚‚ â¨µ Î£â‚â‚) + Î£â‚‚) âŠ” ((sâ‚ƒ â¨µ Î£â‚â‚‚) + Î£â‚ƒ)) â¨° Î£â€²)âŸ§
  delayedÎ£Eq : âˆ€ {N} {Î“ : Î“[ N ]} {eâ‚ eâ€²â‚‚ Ï„â‚ sxâ€ â‚ Î£â‚ Î£â€²â‚ Ï„â‚‚ Î³â€² Î³â€²â‚ Î“â‚ Ï„â‚â‚ Ï„â‚‚â‚}
    â†’ Î“ âŠ¢ eâ‚ â¦‚ Æ›â¦‚ Ï„â‚ â‡’[ âŸ¨ 0 âŸ© âˆ” sxâ€ â‚ âˆ· Î£â‚ ] Ï„â‚‚ , zero
    â†’ Î³â€² âŠ¢ eâ‚ â‡“ (Æ›â¦‚ eâ€²â‚‚ âˆ¥ Î³â€²â‚)
    â†’ Î“â‚ âŠ¢ Æ›â¦‚ Ï„â‚â‚ â‡’ eâ€²â‚‚ â¦‚ Æ›â¦‚ Ï„â‚â‚ â‡’[ âŸ¨ 0 âŸ© âˆ” sxâ€ â‚ âˆ· Î£â€²â‚ ] Ï„â‚‚â‚ , zero
    â†’ Î£â‚ â‰¡ Î£â€²â‚
  gammaDelayedÎ£Eq : âˆ€ {N} {Î³â‚ Î³â‚‚ Î£â€² â„¾ Î£â€²â€²} {â„¾â‚ : Î“[ N ]}
    â†’ âŸ¨ Î³â‚ , Î³â‚‚ âŸ©âˆˆğ’¢âŸ¦ Î£â€² Ë â„¾ âŸ§
    â†’ âŸ¨ Î³â‚ , Î³â‚‚ âŸ©âˆˆğ’¢âŸ¦ Î£â€²â€² Ë mapâ±½ (instantiateÎ£/Ï„ Î£â€²â€²) â„¾â‚ âŸ§
    â†’ Î£â€² â‰¡ Î£â€²â€²
