-- PRIMITIVES

primitive mgauss : âˆ€ Îµâ‚› : â„âº, Î´â‚› : â„âº,m: â„•, n: â„• .
(w : â„âº[Îµâ‚›])
âŠ¸ [wâ‹…0.0] (q : â„âº[Î´â‚›])
âŠ¸ [wâ‹…0.0, qâ‹…0.0] (c : ğ•„ [Lâˆ, U|m, nâ†¦â„ ])
âŠ¸â‹† [ wâ‹…âŸ¨âˆ,âˆâŸ©, qâ‹…âŸ¨âˆ,âˆâŸ©, câ‹…âŸ¨Îµâ‚›,Î´â‚›âŸ© ] ğ•„ [Lâˆ, U|m, nâ†¦â„ ] ,

primitive mmap : âˆ€ Ï„â‚: â˜†,Ï„â‚‚: â˜†,m: â„•, n: â„•,q: â„•, r: â„•,s: â„• .
(a : ğ•„ [Lâˆ, U|m, nâ†¦Ï„â‚ ])
âŠ¸ [aâ‹…q] (b : (c : Ï„â‚) âŠ¸ [câ‹…r] Ï„â‚‚)
âŠ¸ [ bâ‹…s ] ğ•„ [Lâˆ, U|m, nâ†¦Ï„â‚‚ ] ,

primitive mmap2 : âˆ€ Ï„â‚: â˜†,Ï„â‚‚: â˜†,m: â„•, n: â„•, p: â„•,q: â„•, r: â„•,s: â„•,t: â„• .
(aâ‚ : ğ•„ [Lâˆ, U|m, nâ†¦Ï„â‚ ])
âŠ¸ [aâ‚â‹…p] (aâ‚‚ : ğ•„ [Lâˆ, U|m, nâ†¦Ï„â‚ ])
âŠ¸ [aâ‚‚â‹…q] (b : (c : Ï„â‚) âŠ¸ [câ‹…r] (d : Ï„â‚) âŠ¸ [dâ‹…s] Ï„â‚‚)
âŠ¸ [ bâ‹…t ] ğ•„ [Lâˆ, U|m, nâ†¦Ï„â‚‚ ] ,

primitive mLipGrad : âˆ€ m: â„•, n: â„•,q: â„âº, r: â„âº.
(a : ğ•„ [Lâˆ, U|1.0, nâ†¦ğ”» ])
âŠ¸ [aâ‹…1.0] (b : ğ•„ [Lâˆ, L2|m, nâ†¦ğ”» ])
âŠ¸ [bâ‹…q] (c : ğ•„ [Lâˆ, U|m, 1.0â†¦ğ”» ])
âŠ¸ [ câ‹…r ] ğ•„ [Lâˆ, U|1.0, nâ†¦â„ ] ,

primitive matsub : âˆ€ m: â„•, n: â„• .
(Î¸ : ğ•„ [Lâˆ, U|m, nâ†¦ğ”» ])
âŠ¸ [Î¸â‹…0.0] (g : ğ•„ [Lâˆ, U|m, nâ†¦â„ ])
âŠ¸ [Î¸â‹…1.0,gâ‹…1.0] ğ•„ [Lâˆ, U|m, nâ†¦â„ ],

primitive mcreate : âˆ€ m: â„•, n: â„•, Ï„: â˜†.
(x : â„•[m])
âŠ¸ [xâ‹…0.0] (y : â„•[n])
âŠ¸ [yâ‹…0.0] (z : (i : ğ•€[m]) âŠ¸ [iâ‹…0.0] (j : ğ•€[n]) âŠ¸ [jâ‹…0.0] Ï„ )
âŠ¸ [zâ‹…(mâ‹…n)] ğ•„[L1, U|m, nâ†¦Ï„ ],

primitive cols :
âˆ€ m: â„•, n: â„•, Ï„: â˜†.
(x : ğ•„ [Lâˆ, U|m, nâ†¦Ï„ ]) âŠ¸ [xâ‹…1.0] â„•[n],

primitive mclip :
âˆ€ m: â„•, n: â„•, Ï„: â˜†.
(x : ğ•„ [Lâˆ, U|m, nâ†¦Ï„ ]) âŠ¸ [xâ‹…1.0] ğ•„ [Lâˆ, L2|m, nâ†¦Ï„ ],

primitive aloop :
  âˆ€ Îµ: â„âº, Î´: â„âº, Î´â€²: â„âº, k: â„•, n: â„•,
  Î“â‚: cxt, Î“â‚‚: cxt, Î“â‚ƒ: cxt .
  (f : (z : ğ•„ [Lâˆ,U| 1.0,nâ†¦ğ”»])
  âŠ¸â‹†[ Î“â‚â‹…âŸ¨Îµ,Î´âŸ©
    , Î“â‚‚â‹…âŸ¨âˆ,âˆâŸ©
    , zâ‹…âŸ¨âˆ,âˆâŸ©
    , Î“â‚ƒâ‹…âŸ¨0.0,0.0âŸ©
   ] ğ•„ [Lâˆ,U|1.0,nâ†¦â„])
  âŠ¸  [fâ‹…0.0] (x : ğ•„ [L1,U|1.0,nâ†¦â„])
  âŠ¸  [fâ‹…0.0, xâ‹…0.0] (Î´â€²â€² : â„âº[Î´â€²])
  âŠ¸â‹† [ Î“â‚â‹…âŸ¨2.0â‹…Îµâ‹…(âˆš (2.0â‹…kâ‹…(ã’ (1.0/Î´â€²)))),kâ‹…Î´+Î´â€²âŸ©
     , Î“â‚‚â‹…âŸ¨âˆ,âˆâŸ©
     , fâ‹…âŸ¨âˆ,âˆâŸ©
     , xâ‹…âŸ¨âˆ,âˆâŸ©
     , Î´â€²â€²â‹…âŸ¨âˆ,âˆâŸ©
     ] â„


-- primitive rows : âˆ€ m, n, A . ğ•„[l, c|m, nâ‹…A ] âŠ¸[0] â„•[m]
-- primitive cols : âˆ€ m, n, A . ğ•„[l, c|m, nâ‹…A ] âŠ¸[0] â„•[n]
-- primitive discf : âˆ€ A. (A âŠ¸[âŠ¤] â„) âŠ¸[1] (A âŠ¸ [1] ğ”»)
-- primitive undisc : âˆ€ . ğ”» âŠ¸[âŠ¤] â„
-- primitive transpose : âˆ€ m, n, A. ğ•„[L1, c|m, nâ‹…A ] âŠ¸[1] ğ•„[L1, UClip|n, mâ‹…A ]
--
-- primitive convert : âˆ€ m, n. ğ•„[l', l|m, nâ‹…ğ”» ] âŠ¸[1] ğ•„[l, UClip|m, nâ‹…â„ ]
-- primitive clip-l : âˆ€ m, n. ğ•„[l', c|m, nâ‹…ğ”» ] âŠ¸[1] ğ•„[l', l|m, nâ‹…ğ”» ]
-- primitive fr-sens-lâˆ : âˆ€ m, n, A. ğ•„[Lâˆ, c|m, nâ‹…A ] âŠ¸[âˆšn] ğ•„[L2, c|m, nâ‹…A ]
-- primitive fr-sens-l2 : âˆ€ m, n, A. ğ•„[L2, c|m, nâ‹…A ] âŠ¸[âˆšn] ğ•„[L1, c|m, nâ‹…A ]
-- primitive to-sens-l : âˆ€ m, n, A. ğ•„[L1, c|m, nâ‹…A ] âŠ¸[1] ğ•„[l, c|m, nâ‹…A ]
