-- PRIMITIVES

primitive mGauss : ∀ εₛ : ℝ⁺, δₛ : ℝ⁺,m: ℕ, n: ℕ .
(ε : ℝ⁺[εₛ])
⊸ [ε⋅0.0] (δ : ℝ⁺[δₛ])
⊸ [ε⋅0.0, δ⋅0.0] (c : 𝕄 [L∞, U|m, n↦ℝ ])
⊸⋆ [ ε⋅⟨∞,∞⟩, δ⋅⟨∞,∞⟩, c⋅⟨εₛ,δₛ⟩ ] 𝕄 [L∞, U|m, n↦ℝ ] ,

primitive mmap : ∀ τ₁: ☆,τ₂: ☆,m: ℕ, n: ℕ,q: ℕ, r: ℕ,s: ℕ .
(a : 𝕄 [L∞, U|m, n↦τ₁ ])
⊸ [a⋅q] (b : (c : τ₁) ⊸ [c⋅r] τ₂)
⊸ [ b⋅s ] 𝕄 [L∞, U|m, n↦τ₂ ] ,

primitive mmap2 : ∀ τ₁: ☆,τ₂: ☆,m: ℕ, n: ℕ, p: ℕ,q: ℕ, r: ℕ,s: ℕ,t: ℕ .
(a₁ : 𝕄 [L∞, U|m, n↦τ₁ ])
⊸ [a₁⋅p] (a₂ : 𝕄 [L∞, U|m, n↦τ₁ ])
⊸ [a₂⋅q] (b : (c : τ₁) ⊸ [c⋅r] (d : τ₁) ⊸ [d⋅s] τ₂)
⊸ [ b⋅t ] 𝕄 [L∞, U|m, n↦τ₂ ] ,

primitive mLipGrad :
∀ m: ℕ, n: ℕ,q: ℝ⁺, r: ℝ⁺.
(a : 𝕄 [L∞, U|1.0, n↦ℝ ])
⊸ [a⋅∞] (b : 𝕄 [L∞, U|m, n↦𝔻 ])
⊸ [b⋅q] (c : 𝕄 [L∞, U|m, 1.0↦𝔻 ])
⊸ [ c⋅r ] 𝕄 [L∞, U|1.0, n↦ℝ ] ,

primitive matsub :
∀ m: ℕ, n: ℕ .
(a₁ : 𝕄 [L∞, U|m, n↦ℝ ])
⊸ [a₁⋅0.0] (a₂ : 𝕄 [L∞, U|m, n↦ℝ ])
⊸ [a₁⋅1.0,a₂⋅1.0] 𝕄 [L∞, U|m, n↦ℝ ],

primitive mcreate :
∀ m: ℕ, n: ℕ, τ: ☆.
(x : ℕ[m])
⊸ [x⋅0.0] (y : ℕ[n])
⊸ [y⋅0.0] (z : (a : 𝕀[m]) ⊸ [a⋅∞] (b : 𝕀[n]) ⊸ [b⋅∞] τ )
⊸ [z⋅(m⋅n)] 𝕄[L1, U|m, n↦τ ],

primitive mclip :
∀ m: ℕ, n: ℕ, τ: ☆, c: ℕ.
(x : 𝕄 [L∞, U|m, n↦τ ]) ⊸ [x⋅c] 𝕄 [L∞, L2|m, n↦τ ],

primitive aloop :
  ∀ ε: ℝ⁺, δ: ℝ⁺, δ′: ℝ⁺, k: ℕ,
    Γ₁: cxt, Γ₂: cxt .
  (f : (x : ℝ) ⊸⋆[ Γ₁⋅⟨ε,δ⟩ , Γ₂⋅⟨∞,∞⟩ ] ℝ)
  ⊸  [f⋅0.0] (x : ℝ)
  ⊸  [f⋅0.0, x⋅0.0] (δ′ : ℝ⁺[δ′])
  ⊸⋆ [ Γ₁⋅⟨2.0⋅ε⋅(√ (2.0⋅k⋅(㏒ (1.0/δ′)))),k⋅δ+δ′⟩
     , Γ₂⋅⟨∞,∞⟩
     , f⋅⟨∞,∞⟩
     , x⋅⟨∞,∞⟩
     , δ′⋅⟨∞,∞⟩
     ] ℝ


-- primitive rows : ∀ m, n, A . 𝕄[l, c|m, n⋅A ] ⊸[0] ℕ[m]
-- primitive cols : ∀ m, n, A . 𝕄[l, c|m, n⋅A ] ⊸[0] ℕ[n]
-- primitive discf : ∀ A. (A ⊸[⊤] ℝ) ⊸[1] (A ⊸ [1] 𝔻)
-- primitive undisc : ∀ . 𝔻 ⊸[⊤] ℝ
-- primitive transpose : ∀ m, n, A. 𝕄[L1, c|m, n⋅A ] ⊸[1] 𝕄[L1, UClip|n, m⋅A ]
--
-- primitive convert : ∀ m, n. 𝕄[l', l|m, n⋅𝔻 ] ⊸[1] 𝕄[l, UClip|m, n⋅ℝ ]
-- primitive clip-l : ∀ m, n. 𝕄[l', c|m, n⋅𝔻 ] ⊸[1] 𝕄[l', l|m, n⋅𝔻 ]
-- primitive fr-sens-l∞ : ∀ m, n, A. 𝕄[L∞, c|m, n⋅A ] ⊸[√n] 𝕄[L2, c|m, n⋅A ]
-- primitive fr-sens-l2 : ∀ m, n, A. 𝕄[L2, c|m, n⋅A ] ⊸[√n] 𝕄[L1, c|m, n⋅A ]
-- primitive to-sens-l : ∀ m, n, A. 𝕄[L1, c|m, n⋅A ] ⊸[1] 𝕄[l, c|m, n⋅A ]
--
-- primitive mcreate : ∀ m, n, A. ℕ[m] ⊸[0] ℕ[n] ⊸[0] (idx[m] ⊸[⊤] idx[n] ⊸[⊤] A) ⊸[mn] 𝕄[L1, UClip|m, n⋅A ]
-- primitive matrix-map : ∀ m, n, s, A, B . (A ⊸[s] B) ⊸[mn] 𝕄[l, c|m, n⋅A ] ⊸[mn] 𝕄[l, c|m, n⋅B ]
