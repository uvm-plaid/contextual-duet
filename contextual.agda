-- CITATION: Jacob Wunder's proof of metric space conservation for Duet 1.0

module contextual where

open import UVMVS public

_ : â„•
_ = 2

_ : ğ”½
_ = 2.0

_ : ğ”¹
_ = Éª

_ : ğ”¹
_ = á´

-- QUANTITIES --
data qty {â„“} (A : Set â„“) : Set â„“ where
  âŸ¨_âŸ© : A â†’ qty A
  `âˆ : qty A

module _ {â„“} {A : Set â„“} {{_ : has[+] A}} where
  zero[qty] : qty A
  zero[qty] = âŸ¨ zero âŸ©

  _+[qty]_ : qty A â†’ qty A â†’ qty A
  _ +[qty] `âˆ = `âˆ
  `âˆ +[qty] _ = `âˆ
  âŸ¨ x âŸ© +[qty] âŸ¨ y âŸ© = âŸ¨ x + y âŸ©

  {-# DISPLAY _+[qty]_ = _+_ #-}

  instance
    has[+][qty] : has[+] (qty A)
    has[+][qty] = record { zero = zero[qty] ; _+_ = _+[qty]_ }

  module _ {{_ : cor[+] A}} where
    abstract
      lunit[+][qty]<_> : âˆ€ (x : qty A) â†’ zero + x â‰¡ x
      lunit[+][qty]< âŸ¨ x âŸ© > rewrite lunit[+]< x > = â†¯
      lunit[+][qty]< `âˆ > = â†¯

      runit[+][qty]<_> : âˆ€ (x : qty A) â†’ x + zero â‰¡ x
      runit[+][qty]< âŸ¨ x âŸ© > rewrite runit[+]< x > = â†¯
      runit[+][qty]< `âˆ > = â†¯

      commu[+][qty]<_,_> : âˆ€ (x y : qty A) â†’ x + y â‰¡ y + x
      commu[+][qty]< âŸ¨ x âŸ© , âŸ¨ y âŸ© > rewrite commu[+]< x , y > = â†¯
      commu[+][qty]< âŸ¨ x âŸ© , `âˆ > = â†¯
      commu[+][qty]< `âˆ , âŸ¨ y âŸ© > = â†¯
      commu[+][qty]< `âˆ , `âˆ > = â†¯

      assoc[+][qty]<_,_,_> : âˆ€ (x y z : qty A) â†’ x + (y + z) â‰¡ (x + y) + z
      assoc[+][qty]< âŸ¨ x âŸ© , âŸ¨ y âŸ© , âŸ¨ z âŸ© > rewrite assoc[+]< x , y , z > = â†¯
      assoc[+][qty]< âŸ¨ x âŸ© , âŸ¨ y âŸ© , `âˆ > = â†¯
      assoc[+][qty]< âŸ¨ x âŸ© , `âˆ , âŸ¨ z âŸ© > = â†¯
      assoc[+][qty]< âŸ¨ x âŸ© , `âˆ , `âˆ > = â†¯
      assoc[+][qty]< `âˆ , âŸ¨ y âŸ© , âŸ¨ z âŸ© > = â†¯
      assoc[+][qty]< `âˆ , âŸ¨ y âŸ© , `âˆ > = â†¯
      assoc[+][qty]< `âˆ , `âˆ , âŸ¨ z âŸ© > = â†¯
      assoc[+][qty]< `âˆ , `âˆ , `âˆ > = â†¯

    instance
      cor[+][qty] : cor[+] (qty A)
      cor[+][qty] = record
        { lunit[+]<_> = lunit[+][qty]<_>
        ; runit[+]<_> = runit[+][qty]<_>
        ; assoc[+]<_,_,_> = assoc[+][qty]<_,_,_>
        ; commu[+]<_,_> = commu[+][qty]<_,_>
        }

  module _ {{_ : has[Ã—] A}} where
    one[qty] : qty A
    one[qty] = âŸ¨ one âŸ©

    _Ã—[qty]_ : qty A â†’ qty A â†’ qty A
    `âˆ Ã—[qty] _ = `âˆ
    _ Ã—[qty] `âˆ = `âˆ
    âŸ¨ x âŸ© Ã—[qty] âŸ¨ y âŸ© = âŸ¨ x Ã— y âŸ©

    {-# DISPLAY _Ã—[qty]_ = _Ã—_ #-}

    instance
      has[Ã—][qty] : has[Ã—] (qty A)
      has[Ã—][qty] = record { one = one[qty] ; _Ã—_ = _Ã—[qty]_ }

    postulate
      instance
        cor[Ã—][qty] : cor[Ã—] (qty A)


module _ {â„“} {A : Set â„“} {{_ : has[âŠ”] A}} where
  _âŠ”[qty]_ : qty A â†’ qty A â†’ qty A
  _ âŠ”[qty] `âˆ = `âˆ
  `âˆ âŠ”[qty] _ = `âˆ
  âŸ¨ x âŸ© âŠ”[qty] âŸ¨ y âŸ© = âŸ¨ x âŠ” y âŸ©

  instance
    has[âŠ”][qty] : {{_ : has[âŠ”] A}} â†’ has[âŠ”] (qty A)
    has[âŠ”][qty] = record { _âŠ”_ = _âŠ”[qty]_ }

module _ {â„“} {A : Set â„“} {{_ : has[â‰¡?] A}} where

  _â‰¡?[qty]_ : qty A â†’ qty A â†’ â‰¡!
  âŸ¨ xâ‚ âŸ© â‰¡?[qty] âŸ¨ xâ‚‚ âŸ© = xâ‚ â‰¡? xâ‚‚
  âŸ¨ xâ‚ âŸ© â‰¡?[qty] `âˆ = [â‰¢]
  `âˆ â‰¡?[qty] âŸ¨ xâ‚ âŸ© = [â‰¢]
  `âˆ â‰¡?[qty] `âˆ = [â‰¡]

  instance
    has[â‰¡?][qty] : has[â‰¡?] (qty A)
    has[â‰¡?][qty] = record { _â‰¡?_ = _â‰¡?[qty]_ }

  module _ {{_ : cor[â‰¡?] A}} where
    postulate
      instance
        cor[â‰¡?][qty] : cor[â‰¡?] (qty A)

âŒ‰_âŒˆâ¸¢_â¸£ : âˆ€ {â„“â‚ â„“â‚‚} {A : Set â„“â‚} {B : Set â„“â‚‚}
  {{_ : has[+] A}} {{_ : has[â‰¡?] A}} {{_ : has[+] B}}
  â†’ qty A â†’ qty B â†’ qty B
âŒ‰ x âŒˆâ¸¢ y â¸£ with x â‰¡? âŸ¨ zero âŸ©
â€¦ | [â‰¢] = y
â€¦ | [â‰¡] = âŸ¨ zero âŸ©

[vec]âŒ‰_âŒˆâ¸¢_â¸£ : âˆ€ {â„“â‚ â„“â‚‚} {N} {A : Set â„“â‚} {B : Set â„“â‚‚} {{_ : has[+] A}} {{_ : has[â‰¡?] A}} {{_ : has[+] B}}
  â†’ âŸ¬ qty A âŸ­[ N ] â†’ qty B â†’ âŸ¬ qty B âŸ­[ N ]
[vec]âŒ‰ xs âŒˆâ¸¢ q â¸£ = mapâ±½ (Î» x â†’ âŒ‰ x âŒˆâ¸¢ q â¸£) xs

-- SENSITIVITIES --
Sens : Set
Sens = qty â„•

-- sensitivity environment
Î£[_] : â„• â†’ Set
Î£[ N ] = âŸ¬ Sens âŸ­[ N ]

infix 5 Æ›â¦‚_â‡’[_]_
infix 7 _âˆ¥_âŠ—_âˆ¥_
infix 7 _âˆ¥_âŠ•_âˆ¥_

-- TYPES --
data Ï„ : â„• â†’ Set where
  Æ›â¦‚_â‡’[_]_ : âˆ€ {N} â†’ Ï„ N â†’ Î£[ êœ± N ] â†’ Ï„ (êœ± N) â†’ Ï„ N
  _âˆ¥_âŠ—_âˆ¥_ : âˆ€ {N} â†’ Ï„ N â†’ Î£[ N ] â†’ Î£[ N ] â†’ Ï„ N â†’ Ï„ N
  _âˆ¥_âŠ•_âˆ¥_ : âˆ€ {N} â†’ Ï„ N â†’ Î£[ N ] â†’ Î£[ N ] â†’ Ï„ N â†’ Ï„ N
  unit : âˆ€ {N} â†’ Ï„ N
  â„T : âˆ€ {N} â†’ Ï„ N
  ğ”¹T : âˆ€ {N} â†’ Ï„ N

-- type environment
Î“[_] : â„• â†’ Set
Î“[ N ] =  âŸ¬ Ï„ N âŸ­[ N ]

infix 9 `â„_
infix 9 `ğ”¹_
infix 7 _`+_
infix 8 _`Ã—_
infix 6 _`â‰¤_
infix 9 `_
infix 5 Æ›â¦‚_â‡’_
infix 7 _`app_
infix 6 inl_âˆ¥_
infix 6 inr_âˆ¥_
infix 6 case_of_âˆ¥_
infix 6 _`pair_
infix 6 fst_
infix 6 snd_
infix 4 _::_
infix 6 if_âˆ¥_âˆ¥_
infix 6 `let_âˆ¥_

-- TERMS --

data Term : â„• â†’ Set where
  -- real numbers
  `â„_ : âˆ€ {N} â†’ ğ”½ â†’ Term N
  _`+_ : âˆ€ {N} â†’ Term N â†’ Term N â†’ Term N
  _`Ã—_ : âˆ€ {N} â†’ Term N â†’ Term N â†’ Term N
  _`â‰¤_ : âˆ€ {N} â†’ Term N â†’ Term N â†’ Term N
  -- variables, functions, application
  `_ : âˆ€ {N} â†’ idx N â†’ Term N
  Æ›â¦‚_â‡’_ : âˆ€ {N} â†’ Ï„ N â†’ Term (êœ± N) â†’ Term N
  _`app_ : âˆ€ {N} â†’ Term N â†’ Term N â†’ Term N
  -- unit
  tt : âˆ€ {N} â†’ Term N
  -- sums
  inl_âˆ¥_ : âˆ€ {N} â†’ Ï„ N â†’ Term N â†’ Term N
  inr_âˆ¥_ : âˆ€ {N} â†’ Ï„ N â†’ Term N â†’ Term N
  case_of_âˆ¥_ : âˆ€ {N} â†’ Term N â†’ Term (êœ± N) â†’ Term (êœ± N) â†’ Term N
  -- products
  _`pair_ : âˆ€ {N} â†’ Term N â†’ Term N â†’ Term N
  fst_ : âˆ€ {N} â†’ Term N â†’ Term N
  snd_ : âˆ€ {N} â†’ Term N â†’ Term N
  -- ascription
  _::_ : âˆ€ {N} â†’ Term N â†’ Ï„ N â†’ Term N
  -- booleans
  `ğ”¹_ : âˆ€ {N} â†’ ğ”¹ â†’ Term N
  if_âˆ¥_âˆ¥_ : âˆ€ {N} â†’ Term N â†’ Term N â†’ Term N â†’ Term N
  -- let
  `let_âˆ¥_ : âˆ€ {N} â†’ Term N â†’ Term (êœ± N) â†’ Term N

infix 9 inl_
infix 9 inr_
infix 9 ğ“‡_
infix 9 ğ’·_
infix 9 _pair_
infix 5 Æ›â¦‚_âˆ¥_

-- VALUES --
mutual
  data ğ“‹ : Set where
    tt : ğ“‹
    inl_ : ğ“‹ â†’ ğ“‹
    inr_ : ğ“‹ â†’ ğ“‹
    _pair_ : ğ“‹ â†’ ğ“‹ â†’ ğ“‹
    Æ›â¦‚_âˆ¥_ : âˆ€ {N} â†’ Term (êœ± N) â†’ Î³[ N ] â†’ ğ“‹
    ğ’·_ : ğ”¹ â†’ ğ“‹
    ğ“‡_ : ğ”½ â†’ ğ“‹

  -- value environment
  Î³[_] : â„• â†’ Set
  Î³[ N ] = âŸ¬ ğ“‹ âŸ­[ N ]

pred : âˆ€ (N : â„•) â†’ idx N â†’ â„•
pred (êœ± N) á´¢ = N
pred (êœ± N) (êœ± Î¹) = êœ± (pred N Î¹)

infix 6 _âŠŸ_

_âŠŸ_ : âˆ€ {â„“} {A : Set â„“} {N} (Î¹ : idx N) â†’ âŸ¬ A âŸ­[ N ] â†’ âŸ¬ A âŸ­[ pred N Î¹ ]
á´¢ âŠŸ x âˆ· xs = xs
êœ± Î¹ âŠŸ x âˆ· xs = x âˆ· (Î¹ âŠŸ xs)
-- á´¢ âŠŸ x âˆ· vec = vec
-- êœ± () âŠŸ [ x ]
-- êœ± Î¹ âŠŸ x âˆ· y âˆ· vec = x âˆ· (Î¹ âŠŸ (y âˆ· vec))

substÎ£/Î£ : âˆ€ {N} â†’ (Î¹ : idx N) â†’ Î£[ pred N Î¹ ] â†’ Î£[ N ] â†’ Î£[ pred N Î¹ ]
substÎ£/Î£ Î¹ Î£â‚ Î£â‚‚ =
  let s = Î£â‚‚ #[ Î¹ ] in
  let scaled = s â¨µ Î£â‚ in
  (Î¹ âŠŸ Î£â‚‚) + scaled

wkÎ£ : âˆ€ {N} â†’ (Î¹ : idx N) â†’ Î£[ pred N Î¹ ] â†’ Î£[ N ]
wkÎ£ á´¢ Î£ = zero âˆ· Î£
wkÎ£ (êœ± Î¹) (x âˆ· Î£) = x âˆ· wkÎ£ Î¹ Î£

truncÎ£ : âˆ€ {N} â†’ Î£[ (êœ± N) ] â†’ Î£[ N ]
truncÎ£ (x âˆ· Î£) = Î£

substÎ£/Ï„ : âˆ€ {N} â†’ (Î¹ : idx N) â†’ Î£[ pred N Î¹ ] â†’ Ï„ N â†’ Ï„ (pred N Î¹)
substÎ£/Ï„ i Î£ (Æ›â¦‚ Ï„â‚ â‡’[ Î£â€² ] Ï„â‚‚) = Æ›â¦‚ substÎ£/Ï„ i Î£ Ï„â‚ â‡’[ substÎ£/Î£ (êœ± i) (wkÎ£ á´¢ Î£) Î£â€² ] substÎ£/Ï„ (êœ± i) (wkÎ£ á´¢ Î£) Ï„â‚‚
substÎ£/Ï„ i Î£ (Ï„â‚ âˆ¥ x âŠ— xâ‚ âˆ¥ Ï„â‚‚) = substÎ£/Ï„ i Î£ Ï„â‚ âˆ¥ substÎ£/Î£ i Î£ x âŠ— substÎ£/Î£ i Î£ xâ‚ âˆ¥ substÎ£/Ï„ i Î£ Ï„â‚‚
substÎ£/Ï„ i Î£ (Ï„â‚ âˆ¥ x âŠ• xâ‚ âˆ¥ Ï„â‚‚) =  substÎ£/Ï„ i Î£ Ï„â‚ âˆ¥ substÎ£/Î£ i Î£ x âŠ• substÎ£/Î£ i Î£ xâ‚ âˆ¥ substÎ£/Ï„ i Î£ Ï„â‚‚
substÎ£/Ï„ i Î£ unit = unit
substÎ£/Ï„ i Î£ â„T = â„T
substÎ£/Ï„ i Î£ ğ”¹T = ğ”¹T

cut : âˆ€ {N} â†’ Î£[ N ] â†’ Ï„ (êœ± N) â†’ Ï„ N
cut Î£ Ï„ = substÎ£/Ï„ á´¢ Î£ Ï„

â‡§Ë¢â€²<_> : âˆ€ {N} â†’ idx N â†’ Î£[ N ] â†’ Î£[ êœ± N ]
â‡§Ë¢â€²< á´¢ > Î£ = zero âˆ· Î£
â‡§Ë¢â€²< êœ± Î¹ > (Ïƒ âˆ· Î£) = Ïƒ âˆ· â‡§Ë¢â€²< Î¹ > Î£

â‡§Ë¢<_> : âˆ€ {N} â†’ idx (êœ± N) â†’ Î£[ N ] â†’ Î£[ êœ± N ]
â‡§Ë¢< á´¢ > Î£ = zero âˆ· Î£
â‡§Ë¢< êœ± Î¹ > Î£ = â‡§Ë¢â€²< Î¹ > Î£

â‡§áµ—<_> : âˆ€ {N} â†’ idx (êœ± N) â†’ Ï„ N â†’ Ï„ (êœ± N)
â‡§áµ—< Î¹ > (Æ›â¦‚ Ï„â‚ â‡’[ Î£ ] Ï„â‚‚) = Æ›â¦‚ â‡§áµ—< Î¹ > Ï„â‚ â‡’[ â‡§Ë¢< êœ± Î¹ > Î£ ] â‡§áµ—< êœ± Î¹ > Ï„â‚‚
â‡§áµ—< Î¹ > (Ï„â‚ âˆ¥ Î£â‚ âŠ— Î£â‚‚ âˆ¥ Ï„â‚‚) = â‡§áµ—< Î¹ > Ï„â‚ âˆ¥ â‡§Ë¢< Î¹ > Î£â‚ âŠ— â‡§Ë¢< Î¹ > Î£â‚‚ âˆ¥ â‡§áµ—< Î¹ > Ï„â‚‚
â‡§áµ—< Î¹ > (Ï„â‚ âˆ¥ Î£â‚ âŠ• Î£â‚‚ âˆ¥ Ï„â‚‚) = â‡§áµ—< Î¹ > Ï„â‚ âˆ¥ â‡§Ë¢< Î¹ > Î£â‚ âŠ• â‡§Ë¢< Î¹ > Î£â‚‚ âˆ¥ â‡§áµ—< Î¹ > Ï„â‚‚
â‡§áµ—< Î¹ > unit = unit
â‡§áµ—< Î¹ > â„T = â„T
â‡§áµ—< Î¹ > ğ”¹T = ğ”¹T

â‡§áµ— : âˆ€ {N} â†’ Ï„ N â†’ Ï„ (êœ± N)
â‡§áµ— = â‡§áµ—< á´¢ >

â‡§Ë¢ : âˆ€ {N} â†’ Î£[ N ] â†’ Î£[ (êœ± N) ]
â‡§Ë¢ = â‡§Ë¢< á´¢ >

-- JOINS AND MEETS
_âŠ”á´º_ : â„• â†’ â„• â†’ â„•
á´¢ âŠ”á´º á´¢ = á´¢
á´¢ âŠ”á´º êœ± n = êœ± n
êœ± m âŠ”á´º á´¢ = êœ± m
êœ± m âŠ”á´º êœ± n = êœ± (m âŠ”á´º n)

instance
  has[âŠ¥][â„•] : has[âŠ¥] â„•
  has[âŠ¥][â„•] = record { âŠ¥ = 0 }

  has[âŠ”][â„•] : has[âŠ”] â„•
  has[âŠ”][â„•] = record { _âŠ”_ = _âŠ”á´º_ }

_Ï„[âŠ”]_ : âˆ€ {N} â†’ Ï„ N â†’ Ï„ N â†’ â¦‰ Ï„ N â¦Š
(Æ›â¦‚ Ï„â‚â‚ â‡’[ Î£â‚ ] Ï„â‚â‚‚) Ï„[âŠ”] (Æ›â¦‚ Ï„â‚‚â‚ â‡’[ Î£â‚‚ ] Ï„â‚‚â‚‚) with Ï„â‚â‚ Ï„[âŠ”] Ï„â‚‚â‚ | Ï„â‚â‚‚ Ï„[âŠ”] Ï„â‚‚â‚‚
â€¦ | âŸ¨ Ï„â‚â€² âŸ© | âŸ¨ Ï„â‚‚â€² âŸ© = âŸ¨ Æ›â¦‚ Ï„â‚â€² â‡’[ Î£â‚ âŠ” Î£â‚‚ ] Ï„â‚‚â€²  âŸ©   
â€¦ | _ | _ = â€¢
(Ï„â‚â‚ âˆ¥ Î£â‚â‚ âŠ— Î£â‚â‚‚ âˆ¥ Ï„â‚â‚‚) Ï„[âŠ”] (Ï„â‚‚â‚ âˆ¥ Î£â‚‚â‚ âŠ— Î£â‚‚â‚‚ âˆ¥ Ï„â‚‚â‚‚) with Ï„â‚â‚ Ï„[âŠ”] Ï„â‚‚â‚ | Ï„â‚â‚‚ Ï„[âŠ”] Ï„â‚‚â‚‚
â€¦ | âŸ¨ Ï„â‚â€² âŸ© | âŸ¨ Ï„â‚‚â€² âŸ© = âŸ¨ Ï„â‚â€² âˆ¥ Î£â‚â‚ âŠ” Î£â‚‚â‚ âŠ— Î£â‚â‚‚ âŠ” Î£â‚‚â‚‚ âˆ¥ Ï„â‚‚â€² âŸ©   
â€¦ | _ | _ = â€¢
(Ï„â‚â‚ âˆ¥ Î£â‚â‚ âŠ• Î£â‚â‚‚ âˆ¥ Ï„â‚â‚‚) Ï„[âŠ”] (Ï„â‚‚â‚ âˆ¥ Î£â‚‚â‚ âŠ• Î£â‚‚â‚‚ âˆ¥ Ï„â‚‚â‚‚) = {!   !} -- Ï„â‚â‚ Ï„[âŠ”] Ï„â‚‚â‚ âˆ¥ Î£â‚â‚ âŠ” Î£â‚‚â‚ âŠ• Î£â‚â‚‚ âŠ” Î£â‚‚â‚‚ âˆ¥ Ï„â‚â‚‚ Ï„[âŠ”] Ï„â‚‚â‚‚
unit Ï„[âŠ”] unit = âŸ¨ unit âŸ©
â„T Ï„[âŠ”] â„T = âŸ¨ â„T âŸ©
ğ”¹T Ï„[âŠ”] ğ”¹T = âŸ¨ ğ”¹T âŸ©
_ Ï„[âŠ”] _ = â€¢

_Ï„[âŠ“]_ : âˆ€ {N} â†’ Ï„ N â†’ Ï„ N â†’ â¦‰ Ï„ N â¦Š
(Æ›â¦‚ Ï„â‚â‚ â‡’[ Î£â‚ ] Ï„â‚â‚‚) Ï„[âŠ“] (Æ›â¦‚ Ï„â‚‚â‚ â‡’[ Î£â‚‚ ] Ï„â‚‚â‚‚) = {!   !}
(Ï„â‚â‚ âˆ¥ Î£â‚â‚ âŠ— Î£â‚â‚‚ âˆ¥ Ï„â‚â‚‚) Ï„[âŠ“] (Ï„â‚‚â‚ âˆ¥ Î£â‚‚â‚ âŠ— Î£â‚‚â‚‚ âˆ¥ Ï„â‚‚â‚‚) = {!   !}
(Ï„â‚â‚ âˆ¥ Î£â‚â‚ âŠ• Î£â‚â‚‚ âˆ¥ Ï„â‚â‚‚) Ï„[âŠ“] (Ï„â‚‚â‚ âˆ¥ Î£â‚‚â‚ âŠ• Î£â‚‚â‚‚ âˆ¥ Ï„â‚‚â‚‚) = {!   !} -- Ï„â‚â‚ Ï„[âŠ”] Ï„â‚‚â‚ âˆ¥ Î£â‚â‚ âŠ” Î£â‚‚â‚ âŠ• Î£â‚â‚‚ âŠ” Î£â‚‚â‚‚ âˆ¥ Ï„â‚â‚‚ Ï„[âŠ”] Ï„â‚‚â‚‚
unit Ï„[âŠ“] unit = âŸ¨ unit âŸ©
â„T Ï„[âŠ“] â„T = âŸ¨ â„T âŸ©
ğ”¹T Ï„[âŠ“] ğ”¹T = âŸ¨ ğ”¹T âŸ©
_  Ï„[âŠ“] _ = â€¢

-- GROUND TRUTH DYNAMIC SEMANTICS

infix 6 _âŠ¢_â‡“_

data _âŠ¢_â‡“_ : âˆ€ {N} â†’ Î³[ N ] â†’ Term N â†’ ğ“‹ â†’ Set where

  -- RLIT
  âŠ¢`â„ : âˆ€ {N} {Î³ : Î³[ N ]} {r : ğ”½}
      --------------------------------
    â†’ Î³ âŠ¢ (`â„ r) â‡“ ğ“‡ r

  -- BLIT
  âŠ¢`ğ”¹ : âˆ€ {N} {Î³ : Î³[ N ]} {b : ğ”¹}
      --------------------------------
    â†’ Î³ âŠ¢ (`ğ”¹ b) â‡“ ğ’· b

  -- PLUS
  âŠ¢_`+_ : âˆ€ {N} {Î³ : Î³[ N ]} {eâ‚ eâ‚‚ : Term N} {râ‚ râ‚‚ : ğ”½}
      â†’ Î³ âŠ¢ eâ‚ â‡“ ğ“‡ râ‚
      â†’ Î³ âŠ¢ eâ‚‚ â‡“ ğ“‡ râ‚‚
      --------------------------------
      â†’ Î³ âŠ¢ eâ‚ `+ eâ‚‚ â‡“ ğ“‡ (râ‚ + râ‚‚)

  -- TIMES
  âŠ¢_`Ã—_ : âˆ€ {N} {Î³ : Î³[ N ]}  {eâ‚ eâ‚‚ : Term N} {râ‚ râ‚‚ : ğ”½}
      â†’ Î³ âŠ¢ eâ‚ â‡“ ğ“‡ râ‚
      â†’ Î³ âŠ¢ eâ‚‚ â‡“ ğ“‡ râ‚‚
      --------------------------------
      â†’ Î³ âŠ¢ eâ‚ `Ã— eâ‚‚ â‡“ ğ“‡ (râ‚ Ã— râ‚‚)

  -- LEQ
  âŠ¢_`â‰¤_ : âˆ€ {N} {Î³ : Î³[ N ]}  {eâ‚ eâ‚‚ : Term N} {râ‚ râ‚‚ : ğ”½}
      â†’ Î³ âŠ¢ eâ‚ â‡“ ğ“‡ râ‚
      â†’ Î³ âŠ¢ eâ‚‚ â‡“ ğ“‡ râ‚‚
      --------------------------------
      â†’ Î³ âŠ¢ eâ‚ `â‰¤ eâ‚‚ â‡“ ğ’· (primFloatNumericalLess râ‚ râ‚‚) -- NOTE: strict inequality

  -- VAR
  âŠ¢`_ : âˆ€ {N} {Î³ : Î³[ N ]} {i : idx N} {ğ“‹ : ğ“‹}
    â†’ Î³ #[ i ] â‰¡ ğ“‹
    --------------------------------------------------
    â†’ Î³ âŠ¢  ` i â‡“ ğ“‹

  -- UNIT
  âŠ¢`tt : âˆ€ {N} {Î³ : Î³[ N ]}
    ----------------------------
    â†’ Î³ âŠ¢  tt â‡“ tt

  -- INL
  âŠ¢`inl : âˆ€ {N} {Î³ : Î³[ N ]} {e : Term N} {ğ“‹ : ğ“‹} {Ï„â‚‚ : Ï„ N}
    â†’ Î³ âŠ¢ e â‡“ ğ“‹
    --------------------------------------------------
    â†’ Î³ âŠ¢ (inl Ï„â‚‚ âˆ¥ e) â‡“ inl ğ“‹

  -- INR
  âŠ¢`inr : âˆ€ {N} {Î³ : Î³[ N ]} {e : Term N} {ğ“‹ : ğ“‹} {Ï„â‚ : Ï„ N}
    â†’ Î³ âŠ¢ e â‡“ ğ“‹
    --------------------------------------------------
    â†’ Î³ âŠ¢ (inr Ï„â‚ âˆ¥ e) â‡“ inr ğ“‹

  -- CASE-LEFT
  âŠ¢`case/l : âˆ€ {N} {Î³ : Î³[ N ]} {eâ‚ : Term N} {eâ‚‚ eâ‚ƒ : Term (êœ± N)} {ğ“‹â‚ ğ“‹â‚‚ : ğ“‹}
    â†’ Î³ âŠ¢ eâ‚ â‡“ inl ğ“‹â‚
    â†’ (ğ“‹â‚ âˆ· Î³) âŠ¢ eâ‚‚ â‡“ ğ“‹â‚‚
  ------------------------------------------------------------------------------------
    â†’ Î³ âŠ¢ case eâ‚ of eâ‚‚ âˆ¥ eâ‚ƒ â‡“ ğ“‹â‚‚

  -- CASE-RIGHT
  âŠ¢`case/r : âˆ€ {N} {Î³ : Î³[ N ]} {i : idx (êœ± N)} {eâ‚ : Term N} {eâ‚‚ eâ‚ƒ : Term (êœ± N)} {ğ“‹â‚ ğ“‹â‚‚ : ğ“‹}
    â†’ Î³ âŠ¢ eâ‚ â‡“ inl ğ“‹â‚
    â†’ (ğ“‹â‚ âˆ· Î³) âŠ¢ eâ‚ƒ â‡“ ğ“‹â‚‚
  ------------------------------------------------------------------------------------
    â†’ Î³ âŠ¢ case eâ‚ of eâ‚‚ âˆ¥ eâ‚ƒ â‡“ ğ“‹â‚‚

  -- IF-TRUE
  âŠ¢`if-true : âˆ€ {N} {Î³ : Î³[ N ]} {eâ‚ eâ‚‚ eâ‚ƒ : Term N} {ğ“‹ : ğ“‹}
    â†’ Î³ âŠ¢ eâ‚ â‡“ ğ’· Éª
    â†’ Î³ âŠ¢ eâ‚‚ â‡“ ğ“‹
  ------------------------------------------------------------------------------------
    â†’ Î³ âŠ¢ if eâ‚ âˆ¥ eâ‚‚ âˆ¥ eâ‚ƒ â‡“ ğ“‹

  -- IF-FALSE
  âŠ¢`if-false : âˆ€ {N} {Î³ : Î³[ N ]} {eâ‚ eâ‚‚ eâ‚ƒ : Term N} {ğ“‹ : ğ“‹}
    â†’ Î³ âŠ¢ eâ‚ â‡“ ğ’· á´
    â†’ Î³ âŠ¢ eâ‚ƒ â‡“ ğ“‹
  ------------------------------------------------------------------------------------
    â†’ Î³ âŠ¢ if eâ‚ âˆ¥ eâ‚‚ âˆ¥ eâ‚ƒ â‡“ ğ“‹

  -- LET
  âŠ¢`let : âˆ€ {N} {Î³ : Î³[ N ]} {eâ‚ : Term N} {eâ‚‚ : Term (êœ± N)} {ğ“‹â‚ ğ“‹â‚‚ : ğ“‹}
    â†’  Î³ âŠ¢ eâ‚ â‡“ ğ“‹â‚
    â†’  (ğ“‹â‚ âˆ· Î³) âŠ¢ eâ‚‚ â‡“ ğ“‹â‚‚
    -----------------------------------------------
    â†’ Î³ âŠ¢ (`let eâ‚ âˆ¥ eâ‚‚) â‡“ ğ“‹â‚‚

  -- LAM
  âŠ¢`Î» : âˆ€ {N} {Î³ : Î³[ N ]} {e : Term (êœ± N)} {Ï„ : Ï„ N}
    -----------------------------------------------
    â†’ Î³ âŠ¢ (Æ›â¦‚ Ï„ â‡’ e) â‡“ (Æ›â¦‚ e âˆ¥ Î³ )

  -- APP
  âŠ¢`app : âˆ€ {N} {Î³ Î³â€² : Î³[ N ]} {eâ€² : Term (êœ± N)} {eâ‚ eâ‚‚ : Term N} {ğ“‹â‚ ğ“‹â‚‚ : ğ“‹}
    â†’ Î³ âŠ¢ eâ‚ â‡“ (Æ›â¦‚ eâ€² âˆ¥ Î³â€² )
    â†’ Î³ âŠ¢ eâ‚‚ â‡“ ğ“‹â‚
    â†’ ğ“‹â‚ âˆ· Î³â€² âŠ¢ eâ€² â‡“ ğ“‹â‚‚
    -----------------------------------------------------------
    â†’ Î³ âŠ¢ (eâ‚ `app eâ‚‚) â‡“ ğ“‹â‚‚

  -- PAIR
  âŠ¢`_pair_ : âˆ€ {N} {Î³ : Î³[ N ]} {eâ‚ eâ‚‚ : Term N} {ğ“‹â‚ ğ“‹â‚‚ : ğ“‹}
    â†’ Î³ âŠ¢ eâ‚ â‡“ ğ“‹â‚
    â†’ Î³ âŠ¢ eâ‚‚ â‡“ ğ“‹â‚‚
    -----------------------------------------------------------
    â†’ Î³ âŠ¢ eâ‚ `pair eâ‚‚ â‡“ ğ“‹â‚ pair ğ“‹â‚‚

  -- PROJ1
  âŠ¢`fst : âˆ€ {N} {Î³ : Î³[ N ]} {e : Term N} {ğ“‹â‚ ğ“‹â‚‚ : ğ“‹}
    â†’ Î³ âŠ¢ e â‡“ ğ“‹â‚ pair ğ“‹â‚‚
  --------------------------------------
    â†’ Î³ âŠ¢ fst e â‡“ ğ“‹â‚

  -- PROJ2
  âŠ¢`snd : âˆ€ {N} {Î³ : Î³[ N ]} {e : Term N} {ğ“‹â‚ ğ“‹â‚‚ : ğ“‹}
    â†’ Î³ âŠ¢ e â‡“ ğ“‹â‚ pair ğ“‹â‚‚
  -----------------------------------------
    â†’ Î³ âŠ¢ fst e â‡“ ğ“‹â‚‚



-- TYPING JUDGEMENT --
infix 6 _âŠ¢_â¦‚_,_

data _âŠ¢_â¦‚_,_ : âˆ€ {N} â†’ Î“[ N ] â†’ Term N â†’ Ï„ N â†’ Î£[ N ] â†’ Set where

  -- RLIT
  âŠ¢`â„ : âˆ€ {N} {Î“ : Î“[ N ]} {r : ğ”½}
      --------------------------------
    â†’ Î“ âŠ¢ (`â„ r) â¦‚ â„T , zero

  -- BLIT
  âŠ¢`ğ”¹ : âˆ€ {N} {Î“ : Î“[ N ]} {b : ğ”¹}
      --------------------------------
    â†’ Î“ âŠ¢ (`ğ”¹ b) â¦‚ ğ”¹T , zero

  -- PLUS
  âŠ¢_`+_ : âˆ€ {N} {Î“ : Î“[ N ]} {Î£â‚ Î£â‚‚ : Î£[ N ]} {eâ‚ eâ‚‚ : Term N}
      â†’ Î“ âŠ¢ eâ‚ â¦‚ â„T , Î£â‚
      â†’ Î“ âŠ¢ eâ‚‚ â¦‚ â„T , Î£â‚‚
      --------------------------------
      â†’ Î“ âŠ¢ eâ‚ `+ eâ‚‚ â¦‚ â„T , Î£â‚ + Î£â‚‚

  -- TIMES
  âŠ¢_`Ã—_ : âˆ€ {N} {Î“ : Î“[ N ]} {Î£â‚ Î£â‚‚ : Î£[ N ]} {eâ‚ eâ‚‚ : Term N}
      â†’ Î“ âŠ¢ eâ‚ â¦‚ â„T , Î£â‚
      â†’ Î“ âŠ¢ eâ‚‚ â¦‚ â„T , Î£â‚‚
      --------------------------------
      â†’ Î“ âŠ¢ eâ‚ `Ã— eâ‚‚ â¦‚ â„T , [vec]âŒ‰ (Î£â‚ + Î£â‚‚) âŒˆâ¸¢ `âˆ â¸£

  -- LEQ
  âŠ¢_`â‰¤_ : âˆ€ {N} {Î“ : Î“[ N ]} {Î£â‚ Î£â‚‚ : Î£[ N ]} {eâ‚ eâ‚‚ : Term N}
      â†’ Î“ âŠ¢ eâ‚ â¦‚ â„T , Î£â‚
      â†’ Î“ âŠ¢ eâ‚‚ â¦‚ â„T , Î£â‚‚
      --------------------------------
      â†’ Î“ âŠ¢ eâ‚ `â‰¤ eâ‚‚ â¦‚ ğ”¹T , [vec]âŒ‰ (Î£â‚ + Î£â‚‚) âŒˆâ¸¢ `âˆ â¸£

  -- VAR
  âŠ¢`_ : âˆ€ {N} {Î“ : Î“[ N ]} {Î£ : Î£[ N ]} {i : idx N} {Ï„ : Ï„ N}
    â†’ Î“ #[ i ] â‰¡ Ï„
    --------------------------------------------------
    â†’ Î“ âŠ¢  ` i â¦‚ Ï„ , Î£ + zero #[ i â†¦ âŸ¨ 1 âŸ© ]

  -- UNIT
  âŠ¢`tt : âˆ€ {N} {Î“ : Î“[ N ]} {i : idx N} -- {Ï„ : Ï„ N}
    --------------------------------------------------
    â†’ Î“ âŠ¢  tt â¦‚ unit , zero

  -- INL
  âŠ¢`inl : âˆ€ {N} {Î“ : Î“[ N ]} {Î£â‚ : Î£[ N ]} {Î£â‚‚ : Î£[ N ]} {e : Term N} {Ï„â‚ Ï„â‚‚ : Ï„ N}
    â†’ Î“ âŠ¢ e â¦‚ Ï„â‚ , Î£â‚
    --------------------------------------------------
    â†’ Î“ âŠ¢ (inl Ï„â‚‚ âˆ¥ e) â¦‚ (Ï„â‚ âˆ¥ Î£â‚ âŠ• zero âˆ¥ Ï„â‚‚)  , zero

  -- INR
  âŠ¢`inr : âˆ€ {N} {Î“ : Î“[ N ]} {Î£â‚‚ : Î£[ N ]} {e : Term N} {Ï„â‚ Ï„â‚‚ : Ï„ N}
    â†’ Î“ âŠ¢ e â¦‚ Ï„â‚‚ , Î£â‚‚
    --------------------------------------------------
    â†’ Î“ âŠ¢ (inr Ï„â‚ âˆ¥ e) â¦‚ Ï„â‚ âˆ¥ zero âŠ• Î£â‚‚ âˆ¥ Ï„â‚‚  , zero

  -- CASE
  âŠ¢`case : âˆ€ {N} {Î“ : Î“[ N ]} {Î£â‚ Î£â‚â‚ Î£â‚â‚‚ Î£â‚‚ Î£â‚ƒ : Î£[ N ]} {i : idx (êœ± N)} {eâ‚ : Term N} {eâ‚‚ eâ‚ƒ : Term (êœ± N)} {Ï„â‚â‚ Ï„â‚â‚‚ Ï„â‚‚ Ï„â‚ƒ Ï„â‚„ : Ï„ N} {sâ‚‚ sâ‚ƒ : Sens}
    â†’ Î“ âŠ¢ eâ‚ â¦‚ Ï„â‚â‚ âˆ¥ Î£â‚â‚ âŠ• Î£â‚â‚‚ âˆ¥ Ï„â‚â‚‚ , Î£â‚
    â†’ (mapâ±½ â‡§áµ— (Ï„â‚â‚ âˆ· Î“)) âŠ¢ eâ‚‚ â¦‚ (â‡§áµ— Ï„â‚‚) , sâ‚‚ âˆ· Î£â‚‚
    â†’ (mapâ±½ â‡§áµ— (Ï„â‚â‚‚ âˆ· Î“)) âŠ¢ eâ‚ƒ â¦‚ (â‡§áµ— Ï„â‚ƒ) , sâ‚ƒ âˆ· Î£â‚ƒ
    â†’ (cut (Î£â‚ + Î£â‚â‚) (â‡§áµ— Ï„â‚‚)) Ï„[âŠ”] (cut (Î£â‚ + Î£â‚â‚‚) (â‡§áµ— Ï„â‚ƒ)) â‰¡ âŸ¨ Ï„â‚„ âŸ©
  ------------------------------------------------------------------------------------
    â†’ Î“ âŠ¢ case eâ‚ of eâ‚‚ âˆ¥ eâ‚ƒ â¦‚ Ï„â‚„ , [vec]âŒ‰ Î£â‚ âŒˆâ¸¢ `âˆ â¸£ + ((sâ‚‚ â¨µ Î£â‚â‚) + Î£â‚‚) âŠ” ((sâ‚ƒ â¨µ Î£â‚â‚‚) + Î£â‚ƒ)

  -- IF
  âŠ¢`if : âˆ€ {N} {Î“ : Î“[ N ]} {Î£â‚ Î£â‚‚ Î£â‚ƒ : Î£[ N ]} {eâ‚ eâ‚‚ eâ‚ƒ : Term N}  {Ï„ : Ï„ N}
    â†’ Î“ âŠ¢ eâ‚ â¦‚ ğ”¹T , Î£â‚
    â†’ Î“ âŠ¢ eâ‚‚ â¦‚ Ï„ , Î£â‚‚
    â†’ Î“ âŠ¢ eâ‚ƒ â¦‚ Ï„ , Î£â‚ƒ
  ------------------------------------------------------------------------------------
    â†’ Î“ âŠ¢ if eâ‚ âˆ¥ eâ‚‚ âˆ¥ eâ‚ƒ â¦‚ Ï„ , Î£â‚ + (Î£â‚‚ âŠ” Î£â‚ƒ)

  -- LET
  âŠ¢`let : âˆ€ {N} {Î“ : Î“[ N ]} {Î£â‚ Î£â‚‚ : Î£[ N ]} {eâ‚ : Term N} {eâ‚‚ : Term (êœ± N)} {Ï„â‚ : Ï„ N} {Ï„â‚‚ : Ï„ (êœ± N)} {s : Sens}
    â†’  Î“ âŠ¢ eâ‚ â¦‚ Ï„â‚ , Î£â‚
    â†’  (mapâ±½ â‡§áµ— (Ï„â‚ âˆ· Î“)) âŠ¢ eâ‚‚ â¦‚ Ï„â‚‚ , s âˆ· Î£â‚‚
    -----------------------------------------------
    â†’ Î“ âŠ¢ (`let eâ‚ âˆ¥ eâ‚‚) â¦‚  cut Î£â‚ Ï„â‚‚ , (s â¨µ Î£â‚) + Î£â‚‚

  -- LAM
  âŠ¢`Î» : âˆ€ {N} {Î“ : Î“[ N ]} {Î£â‚ : Î£[ êœ± N ]} {i : idx N} {e : Term (êœ± N)} {Ï„â‚ : Ï„ N} {Ï„â‚‚ : Ï„ (êœ± N)}
    â†’  (mapâ±½ â‡§áµ— (Ï„â‚ âˆ· Î“)) âŠ¢ e â¦‚ Ï„â‚‚ , Î£â‚
    -----------------------------------------------
    â†’ Î“ âŠ¢ (Æ›â¦‚ Ï„â‚ â‡’ e) â¦‚ (Æ›â¦‚ Ï„â‚ â‡’[ Î£â‚ ] Ï„â‚‚) , zero

  -- APP
  âŠ¢`app : âˆ€ {N} {i : idx (êœ± N)} {Î“ : Î“[ N ]} {Î£â‚ Î£â‚‚ : Î£[ N ]} {eâ‚ eâ‚‚ : Term N} {Ï„â‚ Ï„â‚‚ : Ï„ N} {s : Sens}
    â†’ Î“ âŠ¢ eâ‚ â¦‚ (Æ›â¦‚ Ï„â‚ â‡’[ s âˆ· Î£â‚ ] â‡§áµ— Ï„â‚‚) , zero
    â†’ Î“ âŠ¢ eâ‚‚ â¦‚ Ï„â‚ , Î£â‚‚
    -----------------------------------------------------------
    â†’ Î“ âŠ¢ (eâ‚ `app eâ‚‚) â¦‚ cut Î£â‚‚ (â‡§áµ— Ï„â‚‚) , (Î£â‚ + (s â¨µ Î£â‚‚))

  -- PAIR
  âŠ¢`_pair_ : âˆ€ {N} {Î“ : Î“[ N ]} {Î£â‚ Î£â‚‚ : Î£[ N ]} {eâ‚ eâ‚‚ : Term N} {Ï„â‚ Ï„â‚‚ : Ï„ N}
    â†’ Î“ âŠ¢ eâ‚ â¦‚ Ï„â‚ , Î£â‚
    â†’ Î“ âŠ¢ eâ‚‚ â¦‚ Ï„â‚‚ , Î£â‚‚
    -----------------------------------------------------------
    â†’ Î“ âŠ¢ eâ‚ `pair eâ‚‚ â¦‚ Ï„â‚ âˆ¥ Î£â‚ âŠ— Î£â‚‚ âˆ¥ Ï„â‚‚ , zero

  -- PROJ1
  âŠ¢`fst : âˆ€ {N} {Î“ : Î“[ N ]} {Î£ Î£â‚ Î£â‚‚ : Î£[ N ]} {e : Term N} {Ï„â‚ Ï„â‚‚ : Ï„ N}
    â†’ Î“ âŠ¢ e â¦‚ Ï„â‚ âˆ¥ Î£â‚ âŠ— Î£â‚‚ âˆ¥ Ï„â‚‚ , Î£
  --------------------------------------
    â†’ Î“ âŠ¢ fst e â¦‚ Ï„â‚ , Î£ + Î£â‚

  -- PROJ2
  âŠ¢`snd : âˆ€ {N} {Î“ : Î“[ N ]} {Î£ Î£â‚ Î£â‚‚ : Î£[ N ]} {e : Term N} {Ï„â‚ Ï„â‚‚ : Ï„ N}
    â†’ Î“ âŠ¢ e â¦‚ Ï„â‚ âˆ¥ Î£â‚ âŠ— Î£â‚‚ âˆ¥ Ï„â‚‚ , Î£
  -----------------------------------------
    â†’ Î“ âŠ¢ fst e â¦‚ Ï„â‚‚ , Î£ + Î£â‚‚

two : Term 0
two = `â„ 2.0

âŠ¢two : âˆ€ {Î“ : Î“[ 0 ]} â†’ Î“ âŠ¢ two â¦‚ â„T , []
âŠ¢two = âŠ¢`â„

_ : âŸ¬ â„• âŸ­[ 2 ]
_ = 1 âˆ· 0 âˆ· []

_ : âŸ¬ â„• âŸ­[ 2 ]
_ = 1 âˆ· 0 âˆ· [] + 1 âˆ· 0 âˆ· []

_ : (1 âˆ· 0 âˆ· [] AT âŸ¬ â„• âŸ­[ 2 ]) + (1 âˆ· 0 âˆ· [] AT âŸ¬ â„• âŸ­[ 2 ]) â‰¡ (2 âˆ· 0 âˆ· [])
_ = â†¯

postulate
  âˆ£_-_âˆ£ : ğ”½ â†’ ğ”½ â†’ â„•
  instance
    has[<] : âˆ€ {â„“ â„“á´¿} {A : Set â„“} {{_ : has[<][ â„“á´¿ ] A}} â†’ has[<][ â„“á´¿ ] (qty A)

data ğ“‹Ï„ : â„• â†’ Set where
  Æ›â¦‚_â‡’[_âˆ”_]_ : âˆ€ {N} â†’ Ï„ N â†’ Sens â†’ Î£[ êœ± N ] â†’ ğ“‹Ï„ (êœ± N) â†’ ğ“‹Ï„ N
  _âˆ¥_âˆ”_âŠ—_âˆ”_âˆ¥_ : âˆ€ {N} â†’ ğ“‹Ï„ N â†’ Sens â†’ Î£[ N ] â†’ Sens â†’ Î£[ N ] â†’ ğ“‹Ï„ N â†’ ğ“‹Ï„ N
  _âˆ¥_âˆ”_âŠ•_âˆ”_âˆ¥_ : âˆ€ {N} â†’ ğ“‹Ï„ N â†’ Sens â†’ Î£[ N ] â†’ Sens â†’ Î£[ N ] â†’ ğ“‹Ï„ N â†’ ğ“‹Ï„ N
  unit : âˆ€ {N} â†’ ğ“‹Ï„ N
  â„T : âˆ€ {N} â†’ ğ“‹Ï„ N
  ğ”¹T : âˆ€ {N} â†’ ğ“‹Ï„ N

mutual
  data âŸ¨_,_âŸ©âˆˆğ’±âŸ¦_Ë_âŸ§ : ğ“‹ â†’ ğ“‹ â†’ Sens â†’ ğ“‹Ï„ á´¢ â†’ Set where
    ğ’±â„ : âˆ€ {râ‚ râ‚‚ : ğ”½} {s : Sens}
      â†’ âŸ¨ âˆ£ râ‚ - râ‚‚ âˆ£ âŸ© < s
      ------------------------------
      â†’ âŸ¨ ğ“‡ râ‚ , ğ“‡ râ‚‚ âŸ©âˆˆğ’±âŸ¦ s Ë â„T âŸ§
    ğ’±âŠ— : âˆ€ {vâ‚â‚ vâ‚â‚‚ vâ‚‚â‚ vâ‚‚â‚‚ s sâ‚ sâ‚‚ Ï„â‚ Ï„â‚‚}
      â†’ âŸ¨ vâ‚â‚ , vâ‚‚â‚ âŸ©âˆˆğ’±âŸ¦ s + sâ‚ Ë Ï„â‚ âŸ§
      â†’ âŸ¨ vâ‚â‚‚ , vâ‚‚â‚‚ âŸ©âˆˆğ’±âŸ¦ s + sâ‚‚ Ë Ï„â‚‚ âŸ§
      ----------------------------------------------------------------
      â†’ âŸ¨ (vâ‚â‚ pair vâ‚â‚‚) , (vâ‚‚â‚ pair vâ‚‚â‚‚) âŸ©âˆˆğ’±âŸ¦ s Ë Ï„â‚ âˆ¥ sâ‚ âˆ” [] âŠ— sâ‚‚ âˆ” [] âˆ¥ Ï„â‚‚ âŸ§

  âŸ¨_,_âŸ©âˆˆâ„°âŸ¦_Ë_âŸ§ : Term á´¢ â†’ Term á´¢ â†’ Sens â†’ ğ“‹Ï„ á´¢ â†’ Set
  âŸ¨ eâ‚ , eâ‚‚ âŸ©âˆˆâ„°âŸ¦ s Ë Ï„ âŸ§ = âˆ€ vâ‚ vâ‚‚ â†’ ([] âŠ¢ eâ‚ â‡“ vâ‚) âˆ§ ([] âŠ¢ eâ‚‚ â‡“ vâ‚‚) â†’ âŸ¨ vâ‚ , vâ‚‚ âŸ©âˆˆğ’±âŸ¦ s Ë Ï„ âŸ§
  

  âŸ¨_,_âŸ©âˆˆğ’±â€²âŸ¦_Ë_âŸ§ : ğ“‹ â†’ ğ“‹ â†’ Sens â†’ ğ“‹Ï„ á´¢ â†’ Set  -- may want assumption of well-typedness, and this will use a type system just for values
  âŸ¨ vâ‚ , vâ‚‚ âŸ©âˆˆğ’±â€²âŸ¦ s Ë Æ›â¦‚ x â‡’[ xâ‚ âˆ” xâ‚‚ ] Ï„â‚ âŸ§ = {!vâ‚!}
  âŸ¨ vâ‚ , vâ‚‚ âŸ©âˆˆğ’±â€²âŸ¦ s Ë Ï„â‚ âˆ¥ x âˆ” xâ‚ âŠ— xâ‚‚ âˆ” xâ‚ƒ âˆ¥ Ï„â‚‚ âŸ§ = {!!}
  âŸ¨ vâ‚ , vâ‚‚ âŸ©âˆˆğ’±â€²âŸ¦ s Ë Ï„â‚ âˆ¥ x âˆ” xâ‚ âŠ• xâ‚‚ âˆ” xâ‚ƒ âˆ¥ Ï„â‚‚ âŸ§ = {!!}
  âŸ¨ vâ‚ , vâ‚‚ âŸ©âˆˆğ’±â€²âŸ¦ s Ë unit âŸ§ = {!!}
  âŸ¨ vâ‚ , vâ‚‚ âŸ©âˆˆğ’±â€²âŸ¦ s Ë â„T âŸ§ = {!!}
  âŸ¨ vâ‚ , vâ‚‚ âŸ©âˆˆğ’±â€²âŸ¦ s Ë ğ”¹T âŸ§ = {!!}
